

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>phenigraph.objet &mdash; PheniGraph 0.2.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../../_static/icone.png"/>
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=bf14799a"></script>
      <script src="../../_static/doctools.js?v=888ff710"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            PheniGraph
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Exemples.html">Examples of uses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../phenigraph.html">PheniGraph package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PheniGraph</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">phenigraph.objet</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for phenigraph.objet</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">distutils.command.config</span> <span class="kn">import</span> <span class="n">config</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">LineCollection</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="n">Colorbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.path</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">PathPatch</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LogNorm</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">to_rgba</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">to_hex</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">sp</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">colorbar</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">griddata</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">alpha</span>

<span class="n">ii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">iinfo</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># Information on numpy&#39;s integer</span>
<span class="n">ii_max</span> <span class="o">=</span> <span class="n">ii</span><span class="o">.</span><span class="n">max</span>  <span class="c1"># The maximum int numerically possible</span>

<span class="n">c</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;ysqgsdkbn&quot;</span>  <span class="c1"># Chain used to fill the gaps in the lists during the saving of the Graphique</span>

<span class="c1">#: Defaults colors :</span>
<span class="n">C1</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#6307ba&#39;</span>  <span class="c1">#: Violet / Purple</span>
<span class="n">C2</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#16b5fa&#39;</span>  <span class="c1">#: Cyan</span>
<span class="n">C3</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#2ad500&#39;</span>  <span class="c1">#: Vert clair / Light green</span>
<span class="n">C4</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#145507&#39;</span>  <span class="c1">#: vert foncé / Dark green</span>
<span class="n">C5</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#ff8e00&#39;</span>  <span class="c1">#: Orange</span>
<span class="n">C6</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#cb0d17&#39;</span>  <span class="c1">#: Rouge / Red</span>
<span class="n">C7</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#5694b2&#39;</span>  <span class="c1">#: Bleu pastel / Pastel blue</span>
<span class="n">C8</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#569a57&#39;</span>  <span class="c1">#: Vert pastel / Pastel green</span>
<span class="n">C9</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#b986b9&#39;</span>  <span class="c1">#: Lavande</span>
<span class="n">C10</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#c6403c&#39;</span>  <span class="c1">#: Rouge pastel / Pastel red</span>
<span class="n">C11</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#d39d5d&#39;</span>  <span class="c1">#: Beige</span>
<span class="n">C12</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#25355d&#39;</span>  <span class="c1">#: Bleu / Blue</span>
<span class="n">C13</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#fcc100&#39;</span>  <span class="c1">#: Jaune / Yellow</span>
<span class="n">C14</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#7ab5fa&#39;</span>  <span class="c1">#: Bleu ciel / Light blue</span>
<span class="n">C15</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#fc2700&#39;</span>  <span class="c1">#: Orange foncé / Dark orange</span>
<span class="n">C16</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#0fc88f&#39;</span>  <span class="c1">#: Bleu-Vert / Blue-Green</span>
<span class="n">C17</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#a8173b&#39;</span>  <span class="c1">#: Rouge cerise / Red</span>
<span class="n">C18</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#1812c4&#39;</span>  <span class="c1">#: Bleu foncé / Dark blue</span>
<span class="n">C19</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#000000&quot;</span>  <span class="c1">#: Noir / Black</span>
<span class="n">C20</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#707070&quot;</span>  <span class="c1">#: Gris / Grey</span>
<span class="n">Ctrensp</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1">#: completely trensparent color (to use for hiding curves for exemple)</span>
<span class="n">l_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">C4</span><span class="p">,</span> <span class="n">C3</span><span class="p">,</span> <span class="n">C5</span><span class="p">,</span> <span class="n">C6</span><span class="p">,</span> <span class="n">C7</span><span class="p">,</span> <span class="n">C8</span><span class="p">,</span> <span class="n">C9</span><span class="p">,</span>
                       <span class="n">C10</span><span class="p">,</span> <span class="n">C11</span><span class="p">,</span> <span class="n">C12</span><span class="p">,</span> <span class="n">C13</span><span class="p">,</span> <span class="n">C14</span><span class="p">,</span> <span class="n">C15</span><span class="p">,</span> <span class="n">C16</span><span class="p">,</span> <span class="n">C17</span><span class="p">,</span> <span class="n">C18</span><span class="p">,</span> <span class="n">C19</span><span class="p">,</span> <span class="n">C20</span><span class="p">]</span>


<div class="viewcode-block" id="linear_color_interpolation">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.linear_color_interpolation">[docs]</a>
<span class="k">def</span> <span class="nf">linear_color_interpolation</span><span class="p">(</span><span class="n">val</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="nb">float</span><span class="p">],</span>
                               <span class="n">val_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">val_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span>
                               <span class="n">col_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="n">C1</span><span class="p">,</span> <span class="n">col_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">C2</span><span class="p">,</span>
                               <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Return a color/list of colors which is linearly interpolated between the two extremal colors col_min</span>
<span class="sd">    and col_max</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    val: np.float64 | float | list[np.float64 | float] | np.ndarray[np.float64 | float],</span>
<span class="sd">        the value to be interpolated</span>
<span class="sd">    val_min: np.float64, default = min(val)</span>
<span class="sd">        the minimal value</span>
<span class="sd">    val_max: np.float64, default = max(val)</span>
<span class="sd">        the maximal value</span>
<span class="sd">    col_min: str | tuple, optional, default=C1=#6307ba (purple)</span>
<span class="sd">        color associated with the minimal value (in hexadecimal or rgba)</span>
<span class="sd">    col_max: str | tuple, optional, default=C2=#16b5fa (cyan)</span>
<span class="sd">        color associated with the maximal value (in hexadecimal or rgba)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str | list[str] | np.ndarray[str]</span>
<span class="sd">        the interpolated color(s) in hex</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_min</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">col_min</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="n">to_rgba</span><span class="p">(</span><span class="n">col_min</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col_max</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">col_max</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="n">to_rgba</span><span class="p">(</span><span class="n">col_max</span><span class="p">)</span>
    <span class="n">col_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">col_min</span><span class="p">)</span>
    <span class="n">col_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">col_max</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">val_min</span> <span class="o">==</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
        <span class="n">val_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">val_max</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
        <span class="n">val_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">float</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">to_hex</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">col_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">col_max</span> <span class="o">-</span> <span class="n">col_min</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">val</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">val_max</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">res</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">to_hex</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">1.</span><span class="p">),</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">),</span> <span class="n">col_min</span> <span class="o">+</span> <span class="p">(</span><span class="n">col_max</span> <span class="o">-</span> <span class="n">col_min</span><span class="p">)</span>
                                                          <span class="o">*</span> <span class="p">(</span><span class="n">v</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">val_max</span> <span class="o">-</span> <span class="n">val_min</span><span class="p">))))))</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">res</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;The values to be interpolated has the wrong type :&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">val</span><span class="p">),</span>
                          <span class="s2">&quot;the only accepted types are float, np.float64, list[np.float64| float], np.ndarray&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="test_list_regular">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.test_list_regular">[docs]</a>
<span class="k">def</span> <span class="nf">test_list_regular</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    If x is a list of lists, this function test if there size is equals.</span>
<span class="sd">    If there are, then it returns a list of string of the same dimensions of x.</span>
<span class="sd">    Then x could be turned into a ndarray and turned back after</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: list</span>
<span class="sd">        the list to be tested</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        the type list or None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># size of the sub list (-1 for scalars or strings)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">dim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dim</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="n">dim</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;str&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;float&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;int64&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;tuple&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;array&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">types</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">test_list_regular</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">types</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Graphique</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;test_list_regular : the type &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="s2">&quot;cannot be saved&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="get_regular_list">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.get_regular_list">[docs]</a>
<span class="k">def</span> <span class="nf">get_regular_list</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">types</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Recover the original list converted by test_list_regular (if the list is regular (the result is not None))</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: np.ndarray | list</span>
<span class="sd">        The converted array</span>
<span class="sd">    types: np.ndarray</span>
<span class="sd">        The types of each list&#39;s element (result of &#39;test_list_regular&#39;)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        the original list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">types</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_regular_list</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">T</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;double&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;tuple&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">T</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;get_regular_list : the type &quot;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="s2">&quot;cannot be loaded&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="list_to_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.list_to_dict">[docs]</a>
<span class="k">def</span> <span class="nf">list_to_dict</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-.-&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x: list</span>
<span class="sd">        the list to be converted</span>
<span class="sd">    separator: str, optinal, default=&quot;-.-&quot;</span>
<span class="sd">        The string to be added between dictionary&#39;s keys if there are recursives</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        the dictionary containing the list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;str&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;double&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;float&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;int64&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;int&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;array&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">loc_types</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">test_list_regular</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">loc_types</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;list_regular&quot;</span><span class="p">])</span>
                <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">loc_types</span><span class="p">)</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">,</span> <span class="s2">&quot;types&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">list_to_dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;list_irregular&quot;</span><span class="p">])</span>
                <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                    <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;list_irregular_values&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;dict&quot;</span><span class="p">])</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;dict_values&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">Graphique</span><span class="p">):</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="s2">&quot;Graphique&quot;</span><span class="p">])</span>
            <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">res</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;Graphique_values&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;list_to_dict : the type &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="s2">&quot;cannot be saved&quot;</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span>
    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">separator</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="dict_to_ndarray_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.dict_to_ndarray_dict">[docs]</a>
<span class="k">def</span> <span class="nf">dict_to_ndarray_dict</span><span class="p">(</span><span class="n">dic</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;-.-&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turn a dictionary containing list, ndarray, str, float, int or even others dic into a dic in the</span>
<span class="sd">    right form to be saved by np.save_compressed</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dic: dict</span>
<span class="sd">        The dictionary to be transformed</span>
<span class="sd">    separator: str, optional, default=&quot;-.-&quot;</span>
<span class="sd">        The string to be added between dictionary&#39;s keys if there are recursives</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        The new dictionary</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s2">&quot;k&quot;</span> <span class="o">==</span> <span class="s2">&quot;types&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;dict_to_ndarray_dict : the key &quot;types&quot; cannot be saved, </span>
<span class="s2">            please replace it with another one&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;str&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;int64&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;int&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;double&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;float&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;tuple&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;array&quot;</span><span class="p">])</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">loc_types</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">test_list_regular</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">loc_types</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;list_regular&quot;</span><span class="p">])</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">loc_types</span><span class="p">)</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">,</span> <span class="s2">&quot;types&quot;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">list_to_dict</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;list_irregular&quot;</span><span class="p">])</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
                <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                    <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;list_irregular_values&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;dict&quot;</span><span class="p">])</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;dict_values&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">Graphique</span><span class="p">):</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">separator</span><span class="o">=</span><span class="n">separator</span><span class="p">)</span>
            <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span><span class="p">,</span> <span class="s2">&quot;Graphique&quot;</span><span class="p">])</span>
            <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>
            <span class="k">for</span> <span class="n">lk</span> <span class="ow">in</span> <span class="n">loc_dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">res</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_dic</span><span class="p">[</span><span class="n">lk</span><span class="p">]</span>
                <span class="n">types</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="n">lk</span><span class="p">,</span> <span class="s2">&quot;Graphique_values&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dict_to_ndarray_dic : the type &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]),</span> <span class="s2">&quot;cannot be saved&quot;</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span>
    <span class="n">res</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">separator</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="dict_to_list">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.dict_to_list">[docs]</a>
<span class="k">def</span> <span class="nf">dict_to_list</span><span class="p">(</span><span class="n">dic</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the irregular list (A list with list of differents sizes or with dictionary(s))</span>
<span class="sd">    transformed by the list_to_dict function</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dic: dict</span>
<span class="sd">        The dic to be converted</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    list</span>
<span class="sd">        The original list</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;separator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dic_to_list, the given dictionary doesn&#39;t contain the required separator key.&quot;</span>
                          <span class="s2">&quot;Either this dict is not the result of list_to_dict either it has been modified&quot;</span><span class="p">)</span>

    <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">])</span>
    <span class="k">del</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">]</span>
    <span class="n">types</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span>
    <span class="n">num_keys</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_keys_int</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">num_keys_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[:</span><span class="n">k</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)]))</span>
            <span class="n">num_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">k</span><span class="p">[:</span><span class="n">k</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)])</span>
                            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">num_keys_int</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">[:</span><span class="n">k</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">separator</span><span class="p">)]))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_keys_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
            <span class="n">num_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                            <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">num_keys_int</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-6</span><span class="p">)</span>
    <span class="n">keys</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">num_keys</span><span class="p">)]</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># while i &lt; len(keys):</span>
    <span class="c1">#     k: str = keys[i]</span>
    <span class="c1">#     if k == &quot;types&quot; or k == &quot;separator&quot;:</span>
    <span class="c1">#         i += 1</span>
    <span class="c1">#     else:  # this is an original element of the list</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="c1"># k = str(ky)</span>
        <span class="c1"># print(&quot;key : &quot;, k)</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">type_i</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">types</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;double&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;tuple&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;list_regular&quot;</span><span class="p">:</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">get_regular_list</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">]))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;list_irregular&quot;</span><span class="p">:</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dict_to_list</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;dict&quot;</span><span class="p">:</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;Graphique&quot;</span><span class="p">:</span>
            <span class="n">loc_graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
            <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">loc_graph</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">))</span>
            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loc_graph</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dict_list : the type &quot;</span><span class="p">,</span> <span class="n">type_i</span><span class="p">,</span> <span class="s2">&quot;cannot be loaded&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="ndarray_dict_to_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.ndarray_dict_to_dict">[docs]</a>
<span class="k">def</span> <span class="nf">ndarray_dict_to_dict</span><span class="p">(</span><span class="n">dic</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the original dictionary get from the dict_to_ndarray_dict</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    dic, dict</span>
<span class="sd">        the dictionary to be converted</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dict</span>
<span class="sd">        the original dictionary</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s2">&quot;separator&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dic_to_list, the given dictionary doesn&#39;t contain the required separator key.&quot;</span>
                          <span class="s2">&quot;Either this dict is not the result of list_to_dict either it has been modified&quot;</span><span class="p">)</span>

    <span class="n">separator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="s2">&quot;separator&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="s2">&quot;types&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dic_to_list, the given dictionary doesn&#39;t contain the required _types key.&quot;</span>
                          <span class="s2">&quot;Either this dict is not the result of list_to_dict either it has been modified&quot;</span><span class="p">,</span>
                          <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">types</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;types&quot;</span><span class="p">]</span>
    <span class="n">keys</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">keys</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">res</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">):</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;types&quot;</span> <span class="ow">or</span> <span class="n">k</span> <span class="o">==</span> <span class="s2">&quot;separator&quot;</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># this is an original element of the list</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">types</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">):</span>
                <span class="n">type_i</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">types</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">k</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;str&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;double&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;float&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;int64&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;int&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;tuple&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;array&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;list_regular&quot;</span><span class="p">:</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_regular_list</span><span class="p">(</span><span class="n">dic</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">dic</span><span class="p">[</span><span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="o">+</span> <span class="s2">&quot;types&quot;</span><span class="p">])</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;list_irregular&quot;</span><span class="p">:</span>
                    <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">keys</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">dict_to_list</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;dict&quot;</span><span class="p">:</span>
                    <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">while</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">type_i</span> <span class="o">==</span> <span class="s2">&quot;Graphique&quot;</span><span class="p">:</span>
                    <span class="n">loc_graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
                    <span class="n">loc_dic</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">while</span> <span class="n">k</span> <span class="o">+</span> <span class="n">separator</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                        <span class="n">loc_dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">separator</span><span class="p">):]]</span> <span class="o">=</span> <span class="n">dic</span><span class="p">[</span><span class="n">keys</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">loc_graph</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="n">loc_dic</span><span class="p">))</span>
                    <span class="n">res</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc_graph</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;dict_list : the type &quot;</span><span class="p">,</span> <span class="n">type_i</span><span class="p">,</span> <span class="s2">&quot;cannot be loaded&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning : &quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span><span class="s2">&quot; is not in the list of types&quot;</span><span class="p">)</span>
                <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="colored_line">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.colored_line">[docs]</a>
<span class="k">def</span> <span class="nf">colored_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">lc_kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function is adapted from https://matplotlib.org/stable/gallery/lines_bars_and_markers/multicolored_line.html</span>
<span class="sd">    Plot a line with a color specified along the line by a third value.</span>

<span class="sd">    It does this by creating a collection of line segments. Each line segment is</span>
<span class="sd">    made up of two straight lines each connecting the current (x, y) point to the</span>
<span class="sd">    midpoints of the lines connecting the current point with its two neighbors.</span>
<span class="sd">    This creates a smooth line with no gaps between the line segments.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x, y : array-like</span>
<span class="sd">        The horizontal and vertical coordinates of the data points.</span>
<span class="sd">    c : array-like</span>
<span class="sd">        The color values, which should be the same size as x and y.</span>
<span class="sd">    ax : Axes</span>
<span class="sd">        Axis object on which to plot the colored line.</span>
<span class="sd">    lc_kwargs</span>
<span class="sd">        Any additional arguments to pass to matplotlib.collections.LineCollection</span>
<span class="sd">        constructor. This should not include the array keyword argument because</span>
<span class="sd">        that is set to the color argument. If provided, it will be overridden.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    matplotlib.collections.LineCollection</span>
<span class="sd">        The generated line collection representing the colored line.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if &quot;array&quot; in lc_kwargs:</span>
    <span class="c1">#     warnings.warn(&#39;The provided &quot;array&quot; keyword argument will be overridden&#39;)</span>

    <span class="c1"># Default the capstyle to butt so that the line segments smoothly line up</span>
    <span class="n">default_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;capstyle&quot;</span><span class="p">:</span> <span class="s2">&quot;butt&quot;</span><span class="p">}</span>
    <span class="n">default_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">lc_kwargs</span><span class="p">)</span>

    <span class="c1"># Compute the midpoints of the line segments. Include the first and last points</span>
    <span class="c1"># twice so we don&#39;t need any special syntax later to handle them.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">x_midpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">y_midpts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

    <span class="c1"># Determine the start, middle, and end coordinate pair of each line segment.</span>
    <span class="c1"># Use the reshape to add an extra dimension so each pair of points is in its</span>
    <span class="c1"># own list. Then concatenate them to create:</span>
    <span class="c1"># [</span>
    <span class="c1">#   [(x1_start, y1_start), (x1_mid, y1_mid), (x1_end, y1_end)],</span>
    <span class="c1">#   [(x2_start, y2_start), (x2_mid, y2_mid), (x2_end, y2_end)],</span>
    <span class="c1">#   ...</span>
    <span class="c1"># ]</span>
    <span class="n">coord_start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x_midpts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_midpts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">coord_mid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">coord_end</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">((</span><span class="n">x_midpts</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">y_midpts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">segments</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">coord_start</span><span class="p">,</span> <span class="n">coord_mid</span><span class="p">,</span> <span class="n">coord_end</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">lc</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">(</span><span class="n">segments</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="o">**</span><span class="n">default_kwargs</span><span class="p">)</span>
    <span class="c1"># lc.set_array(c)  # set the colors of each segment</span>

    <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">lc</span><span class="p">)</span></div>



<span class="c1"># noinspection PyTypeChecker</span>
<div class="viewcode-block" id="Graphique">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique">[docs]</a>
<span class="k">class</span> <span class="nc">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The purpose of this object is to make it easier to create and manipulate graphs</span>
<span class="sd">It contains all the variables required to plot a graph on an axis</span>
<span class="sd">It can be used to display the graph, save it as a .png file and save it using a</span>
<span class="sd">.npy format in order to avoid having to easily regenerate the graph in a reproducible way.</span>

<span class="sd">------------------------Handling procedures----------------------------</span>

<span class="sd">To initialise a Graphique :</span>
<span class="sd">    - For a new Graphique: ```gr=Graphique()```</span>
<span class="sd">    - To open a Graphique with name ```n``` in directory ```f``` :</span>
<span class="sd">        (```n``` and ```f``` are two strings, by default ```f``` is the current working directory)</span>
<span class="sd">        e.g. ```f=&quot;../Images/Graphics&quot;``` and ```n=&quot;test_graphique&quot;```.</span>
<span class="sd">        (the ```.npz``` extension is not mandatory) :</span>
<span class="sd">        - ```gr=Graphique(n)``` if ```n``` is in the current directory</span>
<span class="sd">        - ```gr=Graphique(n, f)``` otherwise</span>

<span class="sd">To save a Graphique :</span>
<span class="sd">    - Assign a name to the graphic, without using an extension :</span>
<span class="sd">        ```gr.filename = &quot;new_name&quot;```</span>
<span class="sd">        The default name is graph_without_name. If you want to save several Graphiques in the same folder</span>
<span class="sd">        it is therefore important to give them a name (not automatically)</span>
<span class="sd">    - If necessary, assign a directory for saving:</span>
<span class="sd">        ```gr.directory=‘new_directory’``` By default, the location is the current working directory.</span>
<span class="sd">    - To save the object :</span>
<span class="sd">        ```gr.save()```</span>
<span class="sd">    - To save the figure :</span>
<span class="sd">        - Assign an extension if necessary (by default the extension is svg).</span>
<span class="sd">            Possible extensions are those available via the matplotlib library: ‘png’, ‘pdf’, ‘svg’, etc.</span>
<span class="sd">            ```gr.ext=&quot;.new_extension&quot;```</span>
<span class="sd">        - ```gr.save_figure()```</span>

<span class="sd">To show the Graphique :</span>
<span class="sd">    - ```gr.show()```</span>

<span class="sd">To add a line (equivalent to plt.plot) :</span>
<span class="sd">    - ```gr.line(x, y, **args)```</span>

<span class="sd">    with x and y the list(s)/ndarray to plot</span>
<span class="sd">    and ```**args``` are all the ather arguments of plt.plot()</span>
<span class="sd">    Can be repeated as many times as required</span>

<span class="sd">To add a histogram :</span>
<span class="sd">    - ```gr.histogram(values, weight=[], normalisation=True, statistic=‘sum’, bins=10, range=None, **args)``` :</span>

<span class="sd">    where</span>
<span class="sd">        - values is the array, the list of values to classify</span>
<span class="sd">        - weights is a list giving a possible weight for each value</span>
<span class="sd">        - normalisation indicates whether the histogram should be normalised</span>
<span class="sd">        - The other arguments are the same as ```plt.hist()```</span>

<span class="sd">    Can be repeated as many times as necessary</span>

<span class="sd">To add an image :</span>
<span class="sd">    - ```gr.image(array,x_axis,y_axis,**args)```</span>

<span class="sd">    where :</span>
<span class="sd">        - ```array``` represents the image to be displayed</span>
<span class="sd">        - ```axis_x``` and ```axis_y``` give the graduations of the image axes</span>
<span class="sd">        - ```**args``` all the other possible arguments for displaying an image</span>

<span class="sd">To add contours :</span>
<span class="sd">    - ```gr.contours(self, contours=np.array([[]]), x_axe=None, y_axe=None, **args)``` :</span>

<span class="sd">   where</span>
<span class="sd">        - ```**args``` gives the possible arguments for ```plt.contours()```</span>
<span class="sd">        - To add level lines to an image complete ```**args```, leaving the other arguments by default</span>

<span class="sd">To add a polygon (coloured area delimited by a list of points) :</span>
<span class="sd">    - ```gr.polygon(ind,alpha0=0.7, facecolor=‘C3’,**args)```</span>

<span class="sd">with ```ind``` an array/list of dimension (n,2) where n is the number of points.</span>
<span class="sd">```ind[:,0]``` corresponds to the abscissas of the points and</span>
<span class="sd">```ind[:1]``` corresponds to the to the ordinates.</span>
<span class="sd">Can be repeated as many times as necessary</span>

<span class="sd">To display several Graphique in one, use a Multigraph</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;.npz&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">filename</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;graph_without_name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>  <span class="c1"># global style:</span>
        <span class="c1"># styles available: plt.style.available : &#39;default&#39; &#39;Solarize_Light2&#39;</span>
        <span class="c1"># &#39;_classic_test_patch&#39; &#39;_mpl-gallery&#39; &#39;_mpl-gallery-nogrid&#39;</span>
        <span class="c1"># &#39;bmh&#39; &#39;classic&#39; &#39;dark_background&#39; &#39;fast&#39; &#39;fivethirtyeight&#39; &#39;ggplot&#39;</span>
        <span class="c1"># &#39;grayscale&#39; &#39;seaborn&#39; &#39;seaborn-bright&#39; &#39;seaborn-colorblind&#39; &#39;seaborn-dark&#39; &#39;seaborn-dark-palette&#39;</span>
        <span class="c1"># &#39;seaborn-darkgrid&#39; &#39;seaborn-deep&#39; &#39;seaborn-muted&#39; &#39;seaborn-notebook&#39; &#39;seaborn-paper&#39; &#39;seaborn-pastel&#39;</span>
        <span class="c1"># &#39;seaborn-poster&#39; &#39;seaborn-talk&#39; &#39;seaborn-ticks&#39; &#39;seaborn-white&#39; &#39;seaborn-whitegrid&#39; &#39;tableau-colorblind10&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">}</span>  <span class="c1"># Contains additional parameters for global font management</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># x axis on the bottom, y axis on the left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># x axis on the top, y axis on the left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># x axis on the bottom, y axis on the right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="p">:</span> <span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># x axis on the top, y axis on the right</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Colorbar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Contains additional parameters for the colorbars ex : label=&quot;legende&quot;...</span>
        <span class="c1"># The first one is automatically associated with the image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># To bild custums discrete colorbars defind by the colors in thoses list (one list for one colorbar)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># The values associated with the colors of self.custum_colorbar_colors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Index of the image&#39;s colorbar(s)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">:</span> <span class="n">Figure</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Contains additional parameters for the Figure ex : facecolor=&quot;w&quot;...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>
        <span class="c1"># Contains additional parameters to save the Figure ex : dpi=300...</span>

        <span class="c1"># orders of axis in the lists : [&quot;bl&quot;, &quot;tl, &quot;tr&quot;, &quot;br&quot;]</span>
        <span class="c1"># liste of position of x-axis ticks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span>
                                                            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])]</span>
        <span class="c1"># List of x-ticks labels if not &quot;empty&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                                      <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])]</span>

        <span class="c1"># liste of position of y-axis ticks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span>
                                                            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])]</span>
        <span class="c1"># List of y-ticks labels if not &quot;empty&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                                      <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of x coordinates to be displayed via plt.plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of y coordinates to be displayed via plt.plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of x coordinates to be displayed via plt.text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of y coordinates to be displayed via plt.text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span>
            <span class="nb">list</span><span class="p">[</span><span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of string to be displayed via plt.text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span>
            <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of errors associated with x coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span>
            <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># list containing lists of errors associated with y coordinates</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Indicate the index of the last color used in line in the list_colors</span>
        <span class="c1"># Additianal parameter&#39;s dictionarys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># for lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># for texts</span>
        <span class="c1"># Order of line plot (default the order of saving)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># histogrammes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of lists of coordinates of the borders of histograms&#39; bars</span>
        <span class="c1"># liste contenant les valeurs des hauteurs de barres des histogrammes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of lists of the values of each histograms&#39; bars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Additional parameters dictionary for plt.bar</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># parameters of plt.legende</span>

        <span class="c1"># Table to plot via plt.pcolor, the limites are x_axe/y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># list of x-coordinate for the image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># list of y-coordinate for the image</span>

        <span class="c1"># Parameters of pcolor colorbar,legend...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># for pcolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[]])</span>
        <span class="c1"># table to plot via contour, the limites are x_axe/y switch of half a bin</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Label to plot for each contours levels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># Mask or index list of labels to plot for contours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># parameter of contours : alpha0,label...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Contains additional parameters for the labels of the contours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># liste of x-coordinate for contours</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>  <span class="c1"># liste of y-coordinate for contours</span>
        <span class="c1"># lists of levels for contours to plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="c1"># number of levels for contours to plot, ignore if levels != np.array([])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># If True, the table used for contour is self.image</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Index of polygone polygons to plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Parameters for the polygons plotting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># If True add a background grid via plt.grid()</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">if</span> <span class="n">directory</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
            <span class="k">elif</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">directory</span><span class="p">:</span>
                <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Cherche la dernière occurrence de &quot;/&quot;</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>
            <span class="n">values_files</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">npyio</span><span class="o">.</span><span class="n">NpzFile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">)</span>
            <span class="n">values_to_load</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">values_files</span><span class="p">))</span>
            <span class="n">values_files</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">)</span>

<div class="viewcode-block" id="Graphique.load_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.load_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">load_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_to_load</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load a Graphique contained in a dictionary</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values_to_load: dict</span>
<span class="sd">            The dictionary that contain all the necessery informations to build a Graphique.</span>
<span class="sd">            Should be produced by another Graphique via Graphique.to_dict()</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.to_dict()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;ext&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;ext&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;style&#39;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_colorbar&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_colorbar&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;ticks_colorbar&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;ticks_colorbar&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;custum_colorbar_colors&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;custum_colorbar_colors&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;custum_colorbar_values&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;custum_colorbar_values&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;index_colorbar_image&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;index_colorbar_image&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_labels_contours&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_labels_contours&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;color_label_contours&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;color_label_contours&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_font&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_font&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_ax&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_ax&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_ax_tl&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_ax_tl&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_ax_br&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_ax_br&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_ax_tr&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_ax_tr&quot;</span><span class="p">]</span>
        <span class="c1"># self.colorbar = None</span>
        <span class="k">if</span> <span class="s2">&quot;param_fig&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_fig&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_enrg_fig&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_enrg_fig&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;x_axe&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;x_axe&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;x_axe&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;x_axe&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;labels_x_ticks&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_x_ticks&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_x_ticks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_x_ticks&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_x_ticks&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;y_axe&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
           <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;y_axe&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;y_axe&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])])</span>
           <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;y_axe&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;labels_y_ticks&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_y_ticks&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_y_ticks&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_y_ticks&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span>
                                                <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s2">&quot;empty&quot;</span><span class="p">])])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;labels_y_ticks&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;lines_x&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;lines_x&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;lines_y&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;lines_y&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;indexs_plot_lines&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;indexs_plot_lines&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;lines_t_x&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;lines_t_x&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;lines_t_y&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;lines_t_y&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;lines_t_s&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;lines_t_s&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;err_x&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;err_x&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;err_y&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;err_y&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;compt_color&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;compt_color&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="s2">&quot;param_lines&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_lines&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_texts&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_texts&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;bords_histogramme&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;bords_histogramme&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;vals_histogramme&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;vals_histogramme&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_histogrammes&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_histogrammes&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_legende&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_legende&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;array_image&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;array_image&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_image&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;x_axe_image&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;y_axe_image&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;contours&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;contours&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;x_axe_contours&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;y_axe_contours&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_contours&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_contours&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;levels&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;levels&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;clabels&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;clabels&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;clabels_mask&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;clabels_mask&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;parameters&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]))</span>
        <span class="k">if</span> <span class="s2">&quot;index_polygons&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;index_polygons&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_polygons&quot;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Graphique.to_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.to_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Build a dictionary containing all the information of this Graphique</span>
<span class="sd">        to save it with np.saved_compressed</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.to_dict()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">enrg</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Dictionary containing all the necessary information :</span>
        <span class="c1"># Used like :  np.savez_compressed(name_fichier,**enrg)</span>

        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;ext&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_colorbar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;ticks_colorbar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;custum_colorbar_colors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;custum_colorbar_values&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;index_colorbar_image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_labels_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_ax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_ax_tl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_ax_br&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_ax_tr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_fig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_enrg_fig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">x_axe</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_axe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">]):</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;x_axe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">labels_x_ticks</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">)</span> 
                                                    <span class="k">for</span> <span class="n">labels_x_ticks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">]):</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;labels_x_ticks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">y_axe</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span> <span class="k">for</span> <span class="n">y_axe</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">]):</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;y_axe&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>  <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">labels_y_ticks</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">)</span> 
                                                    <span class="k">for</span> <span class="n">labels_y_ticks</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">]):</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;labels_y_ticks&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;lines_x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;lines_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;indexs_plot_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;lines_t_x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;lines_t_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;lines_t_s&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;err_x&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;err_y&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;compt_color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_lines&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_texts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;bords_histogramme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;vals_histogramme&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_histogrammes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_legende&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;array_image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;x_axe_image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;y_axe_image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_image&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;array_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;x_axe_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;y_axe_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;color_label_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_contours&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;levels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;clabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;clabels_mask&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span>
        <span class="n">param</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span>
            <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span><span class="p">)),</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">))]</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;parameters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;index_polygons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span>
            <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_polygons&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span>

        <span class="k">return</span> <span class="n">enrg</span></div>


<div class="viewcode-block" id="Graphique.save">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;graph_without_name&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the Graphique in self.directory (default the current working directory) in npz compressed</span>
<span class="sd">        format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        filename: str, optinal, default=&quot;graph_without_name&quot;</span>
<span class="sd">            The name of the .npz file (default: &quot;graph_without_name&quot;)</span>
<span class="sd">        directory: str, optional, default=&quot;./&quot;</span>
<span class="sd">            Graphique&#39;s directory (default self.directory (default : the curent working directory))</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;graph_without_name&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;.npz&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
        <span class="n">enrg</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;-.-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;.npz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.customized_cmap">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.customized_cmap">[docs]</a>
    <span class="k">def</span> <span class="nf">customized_cmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">,</span>
                        <span class="n">colors</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="n">ticks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        values : list[np.float64] | np.ndarray | tuple</span>
<span class="sd">            The values of the colormap&#39;s color intervals if len(values)==2, the interval is automatically</span>
<span class="sd">            defined as a linear subdivision of the interval between values[0] and values[1] of size 255</span>
<span class="sd">        colors : list | np.ndarray | tuple, optional</span>
<span class="sd">            The associated colors, if None, a linear variation beteween C1 and C2 is bild</span>
<span class="sd">        ticks : list | np.ndarray[np.float64], optional</span>
<span class="sd">            Array of ticks for the colorbar If None, ticks are determined automatically from the input.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Additional arguments for the colorbar :</span>
<span class="sd">                - location: str, {&#39;right&#39;, &#39;top&#39;, &#39;bottom&#39;, &#39;left&#39;}</span>
<span class="sd">                    Indicate where the colorbar should be plotted</span>
<span class="sd">                - scale: str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}</span>
<span class="sd">                    The scale of the colorbar</span>
<span class="sd">                - ticks: list | array_like</span>
<span class="sd">                - format: str</span>
<span class="sd">                    ticks&#39; format</span>
<span class="sd">                - label: str</span>
<span class="sd">                    The label to plot along the colorbar</span>
<span class="sd">                - size: float, default=0.01</span>
<span class="sd">                    relative width of the colorbar</span>
<span class="sd">                - fraction: float, default=1</span>
<span class="sd">                    relative hight of the colorbar</span>
<span class="sd">                - space_between: float, default=0.01</span>
<span class="sd">                    relative space between colorsbars (and the plot)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.linspace(0, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; alpha = np.linspace(1, 5, 10)</span>
<span class="sd">        &gt;&gt;&gt; colors = linear_color_interpolation(np.arange(len(alpha)), col_min=g.C1, col_max=g.C2)</span>
<span class="sd">        &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.logy(x, [x**a for a in alpha], color=colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.customized_cmap(alpha, colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.custumized_cmap : the len of values need to be higer than 2&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">255</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">col_min</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_max</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">col_min</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col_max</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.custumized_cmap : values and colors need to have the same size :&quot;</span>
                              <span class="s2">&quot;len(values)=&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="s2">&quot; len(colors)=&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">col_min</span><span class="o">=</span><span class="n">C1</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">C2</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.line">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.line">[docs]</a>
    <span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Equivalent to plt.plot</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, int optional, default=False</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions. If is an integer, the integer refers to the index of a customized cmap</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">            - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, *args)</span>
<span class="sd">                plt.plot(x, y2, *args)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.linspace(0, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; alpha = np.linspace(1, 5, 10)</span>
<span class="sd">        &gt;&gt;&gt; colors = g.linear_color_interpolation(np.arange(len(alpha)), col_min=g.C1, col_max=g.C2)</span>
<span class="sd">        &gt;&gt;&gt; gr = g.Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.line(x, [x*a for a in alpha], color=colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.customized_cmap(alpha, colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">scale_z</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Graphique.line : The scale of the z-axis need to be represanted by a string :</span>
<span class="s2">            &#39;linear&quot;, &#39;log&#39; or &#39;symlog&#39;&quot;&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span>
        <span class="k">if</span> <span class="n">kwargs_colorbar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Graphique.line : The extra arguments ir the colorbar need to be provided thru a </span>
<span class="s2">            dictionary. Not a &quot;&quot;&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs_colorbar</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">scale_z</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">!=</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">!=</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;Graphique.line : The scale of the z-axis can only be</span>
<span class="s2">             &quot;linear&quot;, &quot;log&quot; or &quot;symlog&quot;. Not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">scale_z</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="n">y</span>
            <span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="n">z</span>
            <span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line the x-axis dimension cannot be superior than 2&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dim_x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line the y-axis dimension cannot be superior than 2&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dim_y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line the z-axis dimension cannot be superior than 2&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dim_z</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dim_z</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dim_z</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dim_x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span>
                <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)]))):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of arrays of the abscissa &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the array of ordinates : &quot;</span><span class="p">,</span>
                              <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dim_x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span>
              <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)]))):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of arrays of the z-axis &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the array of ordinates : &quot;</span><span class="p">,</span>
                              <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dim_x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
              <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of the z-axis &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the array of ordinates : &quot;</span><span class="p">,</span>
                              <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span> <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)],</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
              <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">]))):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of the abscissa &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the array of ordinates : &quot;</span><span class="p">,</span>
                              <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span> <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span>
              <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span> <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">z</span><span class="p">]))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of the array of z-axis &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the abscissa : &quot;</span><span class="p">,</span>
                              <span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span> <span class="k">for</span> <span class="n">Z</span> <span class="ow">in</span> <span class="n">z</span><span class="p">],</span> <span class="s2">&quot; or the y-axis :&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span>
              <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of thez-axis &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the abscissa : &quot;</span><span class="p">,</span>
                              <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="s2">&quot; or the y-axis :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of the abscissa &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the ordinate : &quot;</span><span class="p">,</span>
                              <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : There is only one list of ordinate for several&#39;s lists&quot;</span>
                              <span class="s2">&quot;of z. This cannot be represented by a colorscale&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : the sizes of the abscissa &quot;</span>
                              <span class="s2">&quot;doesn&#39;t mach with the sizes of the z-axis : &quot;</span><span class="p">,</span>
                              <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dim_z</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : There is no previous colormap to use to plot the z axis, please set &quot;</span>
                                  <span class="s2">&quot;the parameter share_colorbar to False&quot;</span><span class="p">)</span>
            <span class="n">share_colorbar</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Graphique.line : Warning, no colorbar is provide to plot the z axis, the &#39;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">,</span> <span class="s2">&quot;is used by default&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                            <span class="s2">&quot;Graphique.line : z-axis has no strictly positive values and the scale is log)&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">args_auxi</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">args_auxi</span><span class="p">):</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                <span class="k">elif</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                                        <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span>
                                                                        <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                                        <span class="n">val_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                                                        <span class="n">col_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                                        <span class="n">col_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                               <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                             <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                                        <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                        <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span>
                                                                        <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]),</span>
                                                                        <span class="n">val_min</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span>
                                                                            <span class="n">share_colorbar</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                                                                        <span class="n">val_max</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span>
                                                                            <span class="n">share_colorbar</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                                                                        <span class="n">col_min</span><span class="o">=</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span>
                                                                        <span class="n">col_max</span><span class="o">=</span>
                                                                        <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span> <span class="mi">255</span><span class="p">),</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                               <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                             <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">ma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">&gt;</span> <span class="mf">0.</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">c_med</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">][</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">ma</span><span class="p">]),</span>
                                                                            <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span>
                                                                            <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">][</span><span class="o">~</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]),</span>
                                                                             <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                             <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span>
                                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                    <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
                    <span class="k">if</span>  <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
                    <span class="c1"># Delete empty legend to prevent a warning message and the addition of an empty gray square</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args_auxi</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                           <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                           <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                    <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">dim_x</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                                <span class="s2">&quot;Graphique.line : z-axis has no strictly positive values and the scale is log)&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">((</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                    <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                    <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span> <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">c_med</span><span class="p">)</span>
                <span class="n">ma</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]),</span>
                                                            <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span>
                                                            <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

                <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">colors</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]),</span>
                                                             <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                             <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">idx_s</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">args_auxi</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">args_auxi</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                    <span class="k">elif</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="k">elif</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                                                                             <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)],</span>
                                                                            <span class="n">col_max</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
                                                                                             <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)])</span>

                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
                    <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
                        <span class="c1"># Delete empty legend to prevent a warning message and the addition of an empty gray square</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args_auxi</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="k">elif</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">)</span>
                  <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                     <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                       <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                     <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">)</span>  <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                     <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                       <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                     <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">)</span> <span class="p">:</span>
                <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                     <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                         <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                     <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                         <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span>

        <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.line : z-axis has no strictly positive values and the scale is log)&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">Z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>

                <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Z</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">Z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="n">args_auxi</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">args_auxi</span><span class="p">):</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                <span class="k">elif</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                            <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>

                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">Z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                                    <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span>
                                                                    <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                               <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                             <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>

                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                                    <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                    <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span>
                                                                    <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                               <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                             <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">ma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">&gt;</span> <span class="mf">0.</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">c_med</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">][</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Z</span><span class="p">[</span><span class="n">ma</span><span class="p">]),</span>
                                                                            <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span>
                                                                            <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">][</span><span class="o">~</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">Z</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]),</span>
                                                                             <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                             <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span>
                                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                    <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span>
                                             <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span>
                                             <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
                    <span class="c1"># Delete empty legend to prevent a warning message and the addition of an empty gray square</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args_auxi</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="n">share_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                           <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                           <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                    <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">dim_z</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># if z is None and &quot;color&quot; not in kwargs:</span>
            <span class="c1">#     kwargs[&quot;color&quot;] = l_colors[self.compt_color + 1 % len(l_colors)]</span>
            <span class="c1">#     self.compt_color += 1</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                                <span class="s2">&quot;Graphique.line : z-axis has no strictly positive values and the scale is log)&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">((</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                    <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                    <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span> <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">c_med</span><span class="p">)</span>
                    <span class="n">ma</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]),</span>
                                                                <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span>
                                                                <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">colors</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]),</span>
                                                                 <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                 <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span>
                                                                 <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>

            <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">and</span> <span class="n">i</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">idx_s</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">idx_s</span><span class="p">])</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">)[</span><span class="n">idx_s</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Y</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="n">args_auxi</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>

                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span>
                                <span class="n">y</span><span class="p">):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">args_auxi</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                    <span class="k">elif</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">((</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="o">|</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">marker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span>
                                <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
                    <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">i</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="k">elif</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                            <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
                                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                                                                             <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)],</span>
                                                                            <span class="n">col_max</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
                                                                                             <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)])</span>

                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
                    <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">args_auxi</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
                        <span class="c1"># Delete empty legend to prevent a warning message and the addition of an empty gray square</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args_auxi</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span> <span class="ow">and</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                     <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                       <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                     <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                     <span class="n">colors</span><span class="o">=</span><span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                                                       <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">),</span>
                                     <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                     <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                         <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                    <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                     <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                         <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">idx_s</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="n">idx_s</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">if</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
            <span class="k">elif</span> <span class="n">marker</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">marker</span>
            <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">or</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                            <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                            <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                                <span class="s2">&quot;Graphique.line : z-axis has no strictly positive values and the scale is log)&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                                                       <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                        <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">])</span>
                        <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                        <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">((</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="k">if</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">][</span>
                            <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">share_colorbar</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

                <span class="k">else</span><span class="p">:</span>
                    <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

                <span class="n">idx_s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="mi">0</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
                    <span class="n">idx_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">colors_cmap</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                        <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="n">colors_cmap</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">z_min</span><span class="p">,</span> <span class="n">val_max</span><span class="o">=</span><span class="n">z_max</span><span class="p">,</span>
                                                            <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">idx_s</span><span class="p">]),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                        <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span> <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="n">colors_cmap</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">)),</span> <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min</span><span class="p">),</span>
                                                            <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span> <span class="n">col_min</span><span class="o">=</span><span class="n">c_min</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">colors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">z</span><span class="p">),</span> <span class="n">c_med</span><span class="p">)</span>
                    <span class="n">ma</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">colors</span><span class="p">[</span><span class="n">ma</span><span class="p">]),</span>
                                                                <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span>
                                                                <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">colors</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z</span><span class="p">[</span><span class="o">~</span><span class="n">ma</span><span class="p">]),</span>
                                                                 <span class="n">val_min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                 <span class="n">val_max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span>
                                                                 <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">colors</span>
                <span class="k">if</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">colors_cmap</span><span class="p">,</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">elif</span> <span class="n">scale_z</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span><span class="p">),</span>
                                         <span class="n">colors</span><span class="o">=</span><span class="n">colors_cmap</span><span class="p">,</span>
                                         <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">share_colorbar</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">share_colorbar</span><span class="p">:</span>
                    <span class="n">c_min</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_med</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">c_max</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
                    <span class="n">ma</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mf">0.</span>
                    <span class="n">z_min</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="n">z_max</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_min_pos</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_max_neg</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
                    <span class="k">if</span> <span class="n">z_min_pos</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">,</span> <span class="n">z_max</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_min_pos</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">z_max</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_max</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="k">if</span> <span class="n">z_max_neg</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">,</span> <span class="o">-</span><span class="n">z_max_neg</span><span class="p">,</span> <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">)</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_min</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="o">-</span><span class="n">z_max_neg</span><span class="p">),</span>
                                                                         <span class="mi">255</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
                                                             <span class="n">col_min</span><span class="o">=</span><span class="n">c_med</span><span class="p">,</span> <span class="n">col_max</span><span class="o">=</span><span class="n">c_min</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">z_colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                        <span class="n">colors2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
                    <span class="n">z_colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z_colors2</span><span class="p">,</span> <span class="n">z_colors1</span><span class="p">)</span>
                    <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">colors2</span><span class="p">,</span> <span class="n">colors1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">z_colors</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="n">colors</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span>
                                         <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">4</span>
            <span class="k">if</span> <span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">hide</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">hide</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dim_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">dim_y</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">))))</span></div>


<div class="viewcode-block" id="Graphique.set_indexs_plot_lines">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.set_indexs_plot_lines">[docs]</a>
    <span class="k">def</span> <span class="nf">set_indexs_plot_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indexs</span><span class="o">=</span><span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Set the order in which the lines are plotted. If the index size is smaller than the lists of x/y lines</span>
<span class="sd">        then some of them will not be plotted.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        indexs : list | np.ndarray | str</span>
<span class="sd">            List lines&#39; indexs to plot. The plotting order is the order of index.</span>
<span class="sd">            If index==&quot;default&quot;, then all the lines will be plotted in the order in which they were saved</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indexs</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">indexs</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.set_order_plot_lines : The only string available as parameter is &#39;default&#39;,&quot;</span>
                              <span class="s2">&quot; not &quot;</span><span class="p">,</span> <span class="n">indexs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">indexs</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.set_order_plot_lines : The only type available as parameter are &quot;</span>
                              <span class="s2">&quot;list, array or str not&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">indexs</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">indexs</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indexs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span>
                                                         <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">indexs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.set_order_plot_lines : there is at least one index in the index list&quot;</span><span class="p">,</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">indexs</span><span class="p">),</span> <span class="s2">&quot;that is higher than the maximum possible index &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">indexs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.text">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.text">[docs]</a>
    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
             <span class="n">s</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to ```plt.text```</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        x: list | np.ndarray</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y: list | np.ndarray</span>
<span class="sd">            Ordinate(s)</span>
<span class="sd">        s: list | np.ndarray</span>
<span class="sd">            Texts to plot</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Additional argument to ```plot()``` function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span> <span class="o">==</span> <span class="mi">1</span>
                     <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)))):</span>
            <span class="n">args_auxi</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;axis_config&quot;</span><span class="p">:</span><span class="n">axis_config</span><span class="p">}</span> <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                        <span class="n">args_auxi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
                    <span class="n">args_auxi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">argsS</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">args_auxi</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">argsS</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
              <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graphique.text : the ordinate list should have the same size than &quot;</span>
                             <span class="s2">&quot;the abscissa list len(x): &quot;</span>
                             <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; y : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">))))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
              <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Graphique.text : the ordinate list should have the same size than &quot;</span>
                             <span class="s2">&quot;the text list len(s): &quot;</span>
                             <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; y : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">))))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="c1"># args[&quot;color&quot;] = &#39;C&#39; + str(len(self.lines_x) % 10)</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.point">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.point">[docs]</a>
    <span class="k">def</span> <span class="nf">point</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">yp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">,</span> <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to Graphique.line([xp],[yp],**args)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xp: float | np.double</span>
<span class="sd">            Abscissa</span>
<span class="sd">        yp: float | np.double</span>
<span class="sd">             Ordinate</span>
<span class="sd">        marker: str, optional, default=&quot;o&quot;</span>
<span class="sd">            The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">            see matplotlib documentation for all the possibility</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">([</span><span class="n">xp</span><span class="p">],</span> <span class="p">[</span><span class="n">yp</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span>
                  <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.errorbar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.errorbar">[docs]</a>
    <span class="k">def</span> <span class="nf">errorbar</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">err_y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
            <span class="n">err_x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to plt.errorbar</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : list | array_like</span>
<span class="sd">            Abscissa</span>
<span class="sd">        y : list | array_like</span>
<span class="sd">            Ordinate</span>
<span class="sd">        err_y : list | array_like</span>
<span class="sd">            Error associated with y</span>
<span class="sd">        err_x : list | array_like</span>
<span class="sd">            Error associated with x</span>
<span class="sd">        marker : list[str] | array_like[str], str, optional, default=&quot;&quot;</span>
<span class="sd">            The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">            see matplotlib documentation for all the possibility</span>
<span class="sd">        scale : str, optional, default=&quot;linear&quot;</span>
<span class="sd">            The scales of (x, y) axis :</span>
<span class="sd">            - default : &quot;&quot; (linear scale for both x and y)</span>
<span class="sd">            - polar : polar projection : X=r and Y=theta</span>
<span class="sd">            - loglog, logx, logy : Logarithmic scale for both, x or y axis</span>
<span class="sd">            - symloglog, symlogx, symlogy : Logarithmic scale for both, x or y axis with positive and négative values</span>

<span class="sd">        hide: bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">             Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Graphique.errorbar : no error on the y axis are provided&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of ordinate&#39;s errors array should be equal to the size of &quot;</span>
                <span class="s2">&quot;ordinate array  : len(x)=&quot;</span> <span class="o">+</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; len(y)= &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; shape(err y)&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
              <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">errY</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">errY</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
                          <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">errY</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">errY</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                          <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">errY</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">err_y</span><span class="p">)])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of ordinate&#39;s errors array should be equal to the size of &quot;</span>
                <span class="s2">&quot;ordinate array&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
              <span class="ow">and</span> <span class="p">((</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">))</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
              <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([(</span><span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
                          <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span> <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of ordinate&#39;s errors array should be equal to the size of &quot;</span>
                <span class="s2">&quot;ordinate array&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of abscissa&#39;s errors array should be equal to the size of &quot;</span>
                <span class="s2">&quot;abscissa array  : len(x)=&quot;</span> <span class="o">+</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; len(y)=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; shape(err y)=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                                    <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">errX</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">errX</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
                                                <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">errX</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">errX</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
                                                <span class="k">for</span> <span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">errX</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">err_x</span><span class="p">)])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of abscissa&#39;s errors array should be equal to the size of&quot;</span>
                <span class="s2">&quot;ordinate array&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span>
                                    <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">)</span>
                                                <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
                                                <span class="k">for</span> <span class="n">X</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of abscissa&#39;s errors array should be equal to the size of&quot;</span>
                <span class="s2">&quot;ordinate array&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;polaire&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;loglog&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;logx&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;logy&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symloglog&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symloglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symlogx&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symlogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symlogy&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symlogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The scale &quot;</span> <span class="o">+</span> <span class="n">scale</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot; is not available. Please use : &quot;&quot;, &quot;polar&quot;,</span>
<span class="s2">            &quot;loglog&quot;, &quot;logx&quot;, &quot;logy&quot;, &quot;symloglog&quot;, &quot;symlogx&quot;, &quot;symlogy&quot; &quot;&quot;&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_y</span>
                <span class="k">if</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span>
                <span class="k">elif</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_x</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_y</span>
            <span class="k">if</span> <span class="n">err_x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">err_x</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Graphique.errorplot">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.errorplot">[docs]</a>
    <span class="k">def</span> <span class="nf">errorplot</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">err_y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
            <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to plt.errorbar but the error is not represented by errorbars but by a</span>
<span class="sd">        uniform-colored polygon</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : list | array_like</span>
<span class="sd">            Abscissa</span>
<span class="sd">        y : list | array_like</span>
<span class="sd">            Ordinate</span>
<span class="sd">        err_y : list | array_like</span>
<span class="sd">            Error associated with y</span>
<span class="sd">        marker : list[str] | array_like[str], str, optional, default=&quot;&quot;</span>
<span class="sd">            The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">            see matplotlib documentation for all the possibility</span>
<span class="sd">        scale : str, optional, default=&quot;linear&quot;</span>
<span class="sd">            The scales of (x, y) axis :</span>
<span class="sd">            - default : &quot;&quot; (linear scale for both x and y)</span>
<span class="sd">            - polar : polar projection : X=r and Y=theta</span>
<span class="sd">            - loglog, logx, logy : Logarithmic scale for both, x or y axis</span>
<span class="sd">            - symloglog, symlogx, symlogy : Logarithmic scale for both, x or y axis with positive and négative values</span>

<span class="sd">        hide: bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs</span>
<span class="sd">             Additional argument to plot() function like linestyle, color....</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Graphique.errorbar : no error on the y axis are provided&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Graphique.errorbar the size of errors array should be equal to the size of&quot;</span>
                <span class="s2">&quot;abscissa array  : x :&quot;</span> <span class="o">+</span>
                <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; y : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot; err y : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">err_y</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;polaire&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;loglog&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;logx&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;logy&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">logy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symloglog&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symloglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symlogx&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symlogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">scale</span> <span class="o">==</span> <span class="s2">&quot;symlogy&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">symlogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The scale &quot;</span> <span class="o">+</span> <span class="n">scale</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot; is not available. Please use : &quot;&quot;, &quot;polar&quot;,</span>
<span class="s2">            &quot;loglog&quot;, &quot;logx&quot;, &quot;logy&quot;, &quot;symloglog&quot;, &quot;symlogx&quot;, &quot;symlogy&quot; &quot;&quot;&quot;</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">err_y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">errY</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">err_y</span><span class="p">):</span>
                <span class="n">erry</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">errY</span><span class="p">)</span>
                <span class="n">erry2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">errY</span><span class="p">)</span>
                <span class="n">erry2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">erry</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">erry2</span><span class="p">)</span>
                <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">x2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">x2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
                <span class="n">ind</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">erry</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">Y</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
                <span class="n">erry</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Y</span> <span class="o">+</span> <span class="n">err_y</span><span class="p">)</span>
                <span class="n">erry2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">Y</span> <span class="o">-</span> <span class="n">err_y</span><span class="p">)</span>
                <span class="n">erry2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">erry</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">erry2</span><span class="p">)</span>
                <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">x2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">x2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
                <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
                <span class="n">ind</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">erry</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">erry</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">err_y</span><span class="p">)</span>
            <span class="n">erry2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">err_y</span><span class="p">)</span>
            <span class="n">erry2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">erry</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">erry2</span><span class="p">)</span>
            <span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="n">x2</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">x2</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span>
            <span class="n">ind</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">erry</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">polygon</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;color&quot;</span><span class="p">])</span></div>


<div class="viewcode-block" id="Graphique.polar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.polar">[docs]</a>
    <span class="k">def</span> <span class="nf">polar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">r</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
              <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
              <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span>
              <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Equivalent to self.line in polar projection</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        r : list | array_like</span>
<span class="sd">             Radius</span>
<span class="sd">        theta : list | array_like</span>
<span class="sd">            Angle(s)</span>
<span class="sd">        z : list | array_like, optional</span>
<span class="sd">            z-axis (represented by a colorscale)</span>
<span class="sd">        marker:  : list[str] | array_like, str, optional, default=&quot;&quot;</span>
<span class="sd">            The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">            see matplotlib documentation for all the possibility</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">            If True(default) and z is not None, only one colorscale is used</span>
<span class="sd">            even if z is in two dimensions</span>
<span class="sd">        scale_z: str, optional, {&quot;linear&quot;, &quot;log&quot;, &quot;symlog&quot;}, default=&quot;linear&quot;</span>
<span class="sd">            The scale of the z-axis (linear (default), log, symplog)</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar: dict</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        kwargs</span>
<span class="sd">            Additional argument to plot() function like linestyle, color...</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        The order of first and second arguments is opposit to the matplotlib one :</span>
<span class="sd">        The first argument is the radius, then the angle</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">theta</span><span class="p">]</span>
        <span class="c1"># dim_r: int = 0</span>
        <span class="c1"># dim_theta: int = 0</span>
        <span class="c1"># dim_z: int = 0</span>
        <span class="c1"># if isinstance(theta, str):</span>
        <span class="c1">#     marker = theta</span>
        <span class="c1">#     theta = None</span>
        <span class="c1"># if isinstance(z, str):</span>
        <span class="c1">#     marker = z</span>
        <span class="c1">#     z = None</span>
        <span class="c1"># if theta is None:</span>
        <span class="c1">#     theta = np.copy(r)</span>
        <span class="c1">#     r = np.arange(0, len(theta))</span>
        <span class="c1"># if isinstance(r[0], list) | isinstance(r[0], np.ndarray):</span>
        <span class="c1">#     if isinstance(r[0][0], list) | isinstance(r[0][0], np.ndarray):</span>
        <span class="c1">#         raise UserWarning(&quot;Graphique.line the x-axis dimension cannot be superior than 2&quot;)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         dim_r: int = 2</span>
        <span class="c1"># else:</span>
        <span class="c1">#     dim_r: int = 1</span>
        <span class="c1"># if isinstance(theta[0], list) | isinstance(theta[0], np.ndarray):</span>
        <span class="c1">#     if isinstance(theta[0][0], list) | isinstance(theta[0][0], np.ndarray):</span>
        <span class="c1">#         raise UserWarning(&quot;Graphique.line the y-axis dimension cannot be superior than 2&quot;)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         dim_theta: int = 2</span>
        <span class="c1"># else:</span>
        <span class="c1">#     dim_theta: int = 1</span>
        <span class="c1"># if z is not None and isinstance(z[0], list) | isinstance(z[0], np.ndarray):</span>
        <span class="c1">#     if isinstance(z[0][0], list) | isinstance(z[0][0], np.ndarray):</span>
        <span class="c1">#         raise UserWarning(&quot;Graphique.line the z-axis dimension cannot be superior than 2&quot;)</span>
        <span class="c1">#     else:</span>
        <span class="c1">#         dim_z: int = 2</span>
        <span class="c1"># elif z is None:</span>
        <span class="c1">#     dim_z: int = 0</span>
        <span class="c1"># else:</span>
        <span class="c1">#     dim_z: int = 1</span>
        <span class="c1">#</span>
        <span class="c1"># if (z is None or dim_z == 1) and dim_r == 1 and dim_theta == 2:</span>
        <span class="c1">#     for thet in theta:</span>
        <span class="c1">#         self.line(thet, r, z=z, marker=marker, share_colorbar=share_colorbar,</span>
        <span class="c1">#                   scale_z=scale_z, hide=hide, kwargs_colorbar=kwargs_colorbar, axis_config=axis_config, **kwargs)</span>
        <span class="c1"># if (z is not None and dim_z == 2) and dim_r == 1 and dim_theta == 2:</span>
        <span class="c1">#     for (thet, zz) in zip(theta, z):</span>
        <span class="c1">#         self.line(thet, r, z=zz, marker=marker, share_colorbar=share_colorbar,</span>
        <span class="c1">#                   scale_z=scale_z, hide=hide, kwargs_colorbar=kwargs_colorbar, axis_config=axis_config, **kwargs)</span>
        <span class="c1"># else:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.loglog">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.loglog">[docs]</a>
    <span class="k">def</span> <span class="nf">loglog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
               <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to self.line with a logarithmique scale for both x and y-axis:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">            - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, *args)</span>
<span class="sd">                plt.plot(x, y2, *args)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;]```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.linspace(0, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; alpha = np.linspace(1, 5, 10)</span>
<span class="sd">        &gt;&gt;&gt; colors = g.linear_color_interpolation(np.arange(len(alpha)), col_min=g.C1, col_max=g.C2)</span>
<span class="sd">        &gt;&gt;&gt; gr = g.Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.loglog(x, [x*a for a in alpha], color=colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.customized_cmap(alpha, colors)</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.symloglog">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.symloglog">[docs]</a>
    <span class="k">def</span> <span class="nf">symloglog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to self.line with a logarithmique scale for both x and y-axis</span>
<span class="sd">        Both the negative and positive parts of y are represanted:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">            z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">            If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">            even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">            - ```self.symloglog(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```ax=plt.subplot()</span>
<span class="sd">                ax.plot(x, y1, *args)</span>
<span class="sd">                ax.plot(x, y2, *args)</span>
<span class="sd">                ax.set(xscale=&quot;symlog&quot;, yscale=&quot;symlog&quot;)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.symploglog((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```ax=plt.subplot()</span>
<span class="sd">                ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">                ax.set(xscale=&quot;symlog&quot;, yscale=&quot;symlog&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.linspace(-10, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; gr = g.Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.symloglog(x, np.tan(x))</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.logx">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.logx">[docs]</a>
    <span class="k">def</span> <span class="nf">logx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to self.line with a logarithmique scale for x-axis:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>

<span class="sd">            - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, *args)</span>
<span class="sd">                plt.plot(x, y2, *args)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.logspace(-10, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.logx(x, np.arctan(x))</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.symlogx">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.symlogx">[docs]</a>
    <span class="k">def</span> <span class="nf">symlogx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to self.line with a logarithmique scale for both x-axis (both negative and positive</span>
<span class="sd">        part are represanted):</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">            - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, *args)</span>
<span class="sd">                plt.plot(x, y2, *args)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.append(-np.logspace(10, -10, 1000), np.logspace(-10, 10, 1000))</span>
<span class="sd">        &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.symlogx(x, np.arctan(x))</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">xscale</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.logy">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.logy">[docs]</a>
    <span class="k">def</span> <span class="nf">logy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to ```self.line``` with a logarithmique scale for y-axis:</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>

<span class="sd">            - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, *args)</span>
<span class="sd">                plt.plot(x, y2, *args)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.logspace(-10, 10, 1000)</span>
<span class="sd">        &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.logy(x, np.arctan(x))</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.symlogy">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.symlogy">[docs]</a>
    <span class="k">def</span> <span class="nf">symlogy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to ```self.line``` with a logarithmique scale for y-axis (both positive and negative</span>
<span class="sd">        part are represanted):</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : array_like | list</span>
<span class="sd">            Abscissa(s)</span>
<span class="sd">        y : array_like | list, optional</span>
<span class="sd">            Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">        z : array_like | list, optional</span>
<span class="sd">             z-axis (represented by a colorscale)</span>
<span class="sd">        marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">            The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">        share_colorbar : bool, optional, default=True</span>
<span class="sd">             If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">             even if z is in two dimensions</span>
<span class="sd">        scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">            The scale of the z-axis</span>
<span class="sd">        hide : bool, optional, default=False</span>
<span class="sd">            If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">            To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">        kwargs_colorbar, optional</span>
<span class="sd">            Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs, optional</span>
<span class="sd">            Additional argument to plot() function like linestyle, color....</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">        Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">        Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">        Graphique.point : To plot a single point</span>
<span class="sd">        Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">        Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">        Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">        Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">        Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>

<span class="sd">        Notes</span>
<span class="sd">        -------</span>
<span class="sd">        This function has a small improuvment compared with plt.plot :</span>

<span class="sd">        if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">            - ```self.symlogy(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">                ```ax = plt.subplot()</span>
<span class="sd">                ax.plot(x, y1, *args)</span>
<span class="sd">                ax.plot(x, y2, *args)</span>
<span class="sd">                ax.set(yscale=&quot;symplog&quot;)```</span>
<span class="sd">            - if y1 and y2 have not the same size:</span>
<span class="sd">                ```self.symlogy([x1,x2],[y1, y2], *args)```</span>
<span class="sd">            - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">                ```self.symplogy((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">                is equivalent to</span>
<span class="sd">                ```ax=plt.subplot()</span>
<span class="sd">                ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">                ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">                ax.set(yscale=&quot;symlog&quot;)```</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; x = np.linspace(0,np.pi,1000)</span>
<span class="sd">        &gt;&gt;&gt; gr = g.Graphique()</span>
<span class="sd">        &gt;&gt;&gt; gr.symlogy(x, np.tan(x))</span>
<span class="sd">        &gt;&gt;&gt; gr.show()</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config_ax</span><span class="p">(</span><span class="n">yscale</span><span class="o">=</span><span class="s2">&quot;symlog&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis_config</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.histogram">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.histogram">[docs]</a>
    <span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">stat_args</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the histogram of values</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : array_like</span>
<span class="sd">            The values to histogramed</span>
<span class="sd">        weights : array_like, optional</span>
<span class="sd">            The weights to be applied to values</span>
<span class="sd">        normalization : bool, optional, default=True</span>
<span class="sd">            If the histogram is normalized or not</span>
<span class="sd">        statistic : str, optional, default=&quot;sum&quot;</span>
<span class="sd">            The statistic to compute.</span>
<span class="sd">            The following statistics are available</span>

<span class="sd">                - &#39;mean&#39;: compute the mean of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">                - &#39;std&#39;: compute the standard deviation within each bin. This is implicitly calculated with ddof=0.</span>
<span class="sd">                - &#39;median&#39;: compute the median of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">                - &#39;count&#39;: compute the count of points within each bin. This is identical to an unweighted histogram. values array is not</span>
<span class="sd">                    referenced.</span>
<span class="sd">                - &#39;sum&#39;: compute the sum of values for points within each bin. This is identical to a weighted histogram.</span>
<span class="sd">                - &#39;min&#39;: compute the minimum of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">                - &#39;max&#39;: compute the maximum of values for point within each bin. Empty bins will be represented by NaN.</span>

<span class="sd">        bins : int, optional, default=10</span>
<span class="sd">            Number of bins in the histogram</span>
<span class="sd">        stat_args, dict, optional</span>
<span class="sd">            Additionals argument for `sp.binned_statistic`</span>
<span class="sd">        kwargs</span>
<span class="sd">             Additionals argument for plt.bars</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        scipy.stats.binned_statistic</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">stat_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stat_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="n">vals</span><span class="p">,</span> <span class="n">bds</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">sp</span><span class="o">.</span><span class="n">binned_statistic</span><span class="p">(</span>
            <span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="o">**</span><span class="n">stat_args</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">normalization</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
            <span class="n">vals</span> <span class="o">/=</span> <span class="n">bds</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">bds</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.image">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.image">[docs]</a>
    <span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">array_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
              <span class="n">x_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">colorscale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span>
              <span class="n">cmap</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">colorbar_ticks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">colorbar_label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">colorbar_index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ii_max</span><span class="p">,</span>
              <span class="n">vmin</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">vmax</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span>
              <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Plot the array image through plt.pcolor or plt.imshow for 3 color images</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        array_image : np.ndarray</span>
<span class="sd">            The matrix (2D, or 3D for colored images (the color is on the third axis)) to be plotted</span>
<span class="sd">        x_axe : list | np.ndarray, optional, default=np.arange(0,array_image.shape[0])</span>
<span class="sd">            The x-axes coordinate (for the array), only for 2d array_image</span>
<span class="sd">        y_axe : list | np.ndarray, optional, default=np.arange(0,array_image.shape[1])</span>
<span class="sd">            The y-axes coordinate (for the array), only for 2d array_image</span>
<span class="sd">        colorscale : str, optional, default=&quot;linear&quot;, {&quot;linear&quot;, &quot;log&quot;, &quot;symlog&quot;}</span>
<span class="sd">            The scale for the colorbar</span>
<span class="sd">        cmap : str, optional, default=&quot;default&quot;</span>
<span class="sd">            The colormap, default a linear color interpolation between two colors CX</span>
<span class="sd">        colorbar_ticks : list | array_like, optional</span>
<span class="sd">            The colorbar&#39;s ticks</span>
<span class="sd">        colorbar_label : str, optional, default=&quot;&quot;</span>
<span class="sd">            The colorbar&#39;s label</span>
<span class="sd">        kwargs_colorbar : dict, optional</span>
<span class="sd">            Additional arguments for the colorbar :</span>

<span class="sd">                - location: str, {&#39;right&#39;, &#39;top&#39;, &#39;bottom&#39;, &#39;left&#39;}</span>
<span class="sd">                    Indicate where the colorbar should be plotted</span>
<span class="sd">                - scale: str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}</span>
<span class="sd">                    The scale of the colorbar</span>
<span class="sd">                - ticks: list | array_like</span>
<span class="sd">                - format: str</span>
<span class="sd">                    ticks&#39; format</span>
<span class="sd">                - label: str</span>
<span class="sd">                    The label to plot along the colorbar</span>
<span class="sd">                - size: float, default=0.01</span>
<span class="sd">                    relative width of the colorbar</span>
<span class="sd">                - fraction: float, default=1</span>
<span class="sd">                    relative hight of the colorbar</span>
<span class="sd">                - space_between: float, default=0.01</span>
<span class="sd">                    relative space between colorsbars (and the plot)</span>

<span class="sd">        colorbar_index : int, optional</span>
<span class="sd">            The index of a previouly defined colorbar, to use insted of building a new one, all the others colorbar are</span>
<span class="sd">            ignored if provided</span>
<span class="sd">        vmin : np.float64, optional, default : the minimum of array_image</span>
<span class="sd">            The minimum value for the colorbar</span>
<span class="sd">        vmax : np.float64, optional, default : the maximum of array_image</span>
<span class="sd">            The maximum value for the colorbar</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Additionals arguments for pcolor</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        matplotlib.pyplot.pcolor</span>
<span class="sd">            Use to plot 2d array images</span>
<span class="sd">        matplotlib.pyplot.imshow</span>
<span class="sd">            Use to plot 3-colors images</span>
<span class="sd">        Graphique.contours</span>
<span class="sd">            To draw levels lines onto the image</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x_axe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">x_axe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">y_axe</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">y_axe</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="o">==</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array_image</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array_image</span><span class="p">[</span><span class="n">array_image</span> <span class="o">&lt;</span> <span class="n">vmin</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmin</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
            <span class="n">vmax</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array_image</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">array_image</span><span class="p">[</span><span class="n">array_image</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmax</span>
        <span class="k">if</span> <span class="n">kwargs_colorbar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">colorscale</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
            <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">colorscale</span> <span class="o">==</span> <span class="s2">&quot;log&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vmin</span> <span class="o">&lt;=</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">array_image</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">):</span>
                <span class="n">vmin</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array_image</span><span class="p">[</span><span class="n">array_image</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">])</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">array_image</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.image : There is no positive values to plot with the log scale&quot;</span><span class="p">)</span>
            <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">colorscale</span> <span class="o">==</span> <span class="s2">&quot;symlog&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">vmin</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">vmax</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">vmin</span><span class="p">,</span> <span class="o">-</span><span class="n">vmax</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">vneg_sup</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array_image</span><span class="p">[</span><span class="n">array_image</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">])</span>
                <span class="n">vpos_inf</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array_image</span><span class="p">[</span><span class="n">array_image</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">])</span>
                <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="o">-</span><span class="n">vmin</span><span class="p">,</span> <span class="o">-</span><span class="n">vneg_sup</span><span class="p">,</span>
                                                                              <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmin</span> <span class="o">/</span> <span class="n">vneg_sup</span><span class="p">)</span>
                                                                                      <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmin</span> <span class="o">/</span> <span class="n">vneg_sup</span><span class="p">)</span>
                                                                                         <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmax</span> <span class="o">/</span> <span class="n">vpos_inf</span><span class="p">)))</span>
                                                                                  <span class="o">*</span> <span class="mi">255</span><span class="p">)),</span>
                                                                 <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">vpos_inf</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span>
                                                                              <span class="nb">int</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmax</span> <span class="o">/</span> <span class="n">vpos_inf</span><span class="p">)</span>
                                                                                      <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmin</span> <span class="o">/</span> <span class="n">vneg_sup</span><span class="p">)</span>
                                                                                         <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vmax</span> <span class="o">/</span> <span class="n">vpos_inf</span><span class="p">)))</span>
                                                                                  <span class="o">*</span> <span class="mi">255</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color_values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">colorscale</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.image : The array_image have not the right shape to plot a color image&quot;</span><span class="p">)</span>
            <span class="n">array_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">array_image</span><span class="p">,</span> <span class="n">color_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="o">!=</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning Graphique.image : for colored images, the colorbars parameters are ignored&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs_colorbar</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs_colorbar</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span>
            <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs_colorbar</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">kwargs_colorbar</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.02</span>

            <span class="n">colors_r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)),</span>
                                                                   <span class="n">col_min</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                                                                   <span class="n">col_max</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">color_values</span><span class="p">,</span> <span class="n">colors_r</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">colorbar_ticks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">colorbar_label</span><span class="p">,</span>
                                 <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">colors_v</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)),</span>
                                                                   <span class="n">col_min</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                                                                   <span class="n">col_max</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">color_values</span><span class="p">,</span> <span class="n">colors_v</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">space_between</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

            <span class="n">colors_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)),</span>
                                                                   <span class="n">col_min</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                                                                   <span class="n">col_max</span><span class="o">=</span><span class="n">to_hex</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">color_values</span><span class="p">,</span> <span class="n">colors_b</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_axis</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                 <span class="n">space_between</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">colorbar_index</span> <span class="o">==</span> <span class="n">ii_max</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cmap</span> <span class="o">==</span> <span class="s2">&quot;default&quot;</span><span class="p">:</span>
                <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">linear_color_interpolation</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)),</span>
                                                                     <span class="n">col_min</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                                                                                      <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)],</span>
                                                                     <span class="n">col_max</span><span class="o">=</span><span class="n">l_colors</span><span class="p">[(</span><span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
                                                                                      <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_colors</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">compt_color</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">elif</span> <span class="n">cmap</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.image : the colorbar &quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="p">,</span>
                                  <span class="s2">&quot;isn&#39;t awalible. Please use &quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">colormaps</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cmap_auxi</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                <span class="n">colors</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">to_hex</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span>
                                                    <span class="n">cmap_auxi</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">color_values</span><span class="p">)))])</span>
            <span class="k">if</span> <span class="n">kwargs_colorbar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs_colorbar</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">customized_cmap</span><span class="p">(</span><span class="n">color_values</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">colorbar_ticks</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">colorbar_label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs_colorbar</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">cmap</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span> <span class="o">=</span> <span class="n">array_image</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_axe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_axe</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span> <span class="o">=</span> <span class="n">kwargs</span></div>


<div class="viewcode-block" id="Graphique.contours">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.contours">[docs]</a>
    <span class="k">def</span> <span class="nf">contours</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">array_contours</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">x_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">y_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">labels_mask</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Plot the level lines associated to self.array_image or array_contours</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        levels : int | array_like | list, optional</span>
<span class="sd">            Number (or list of) levels to plot</span>
<span class="sd">        array_contours : array_like, optional, default=self.arry_image</span>
<span class="sd">            If not None, the reference array to determine the level</span>
<span class="sd">        x_axe : array_like | list, optional</span>
<span class="sd">            the x-axes coordinate (for the array if array_contour is not None)</span>
<span class="sd">        y_axe : array_like | list, optional</span>
<span class="sd">            the y-axes coordinate (for the array if array_contour is not None)</span>
<span class="sd">        labels : array_like | list, optional</span>
<span class="sd">            the labels of each level line</span>
<span class="sd">        labels_mask : array_like | list, optional</span>
<span class="sd">            the mask of levels line to show the labels</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">            additional arguments</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>


<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.pyplot.contour</span>
<span class="sd">            Used to plot the levels lines</span>
<span class="sd">        Graphique.image</span>
<span class="sd">            To plot an image, this image can be used as a reference for the levels lines</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span>
        <span class="n">idx_levels</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">idx_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">levels</span><span class="p">)</span>
            <span class="n">levels</span> <span class="o">=</span> <span class="n">levels</span><span class="p">[</span><span class="n">idx_levels</span><span class="p">]</span>

        <span class="k">if</span> <span class="s2">&quot;colors&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">list</span>
                                          <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">])</span> <span class="ow">is</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">levels</span>
            <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.contours : the labels size should be equal to the levels size: levels&quot;</span><span class="p">,</span>
                                      <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">),</span> <span class="s2">&quot;labels :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">idx_levels</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">labels_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_mask</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.contours : the labels_mask size should be equal &quot;</span>
                                          <span class="s2">&quot;to the levels/labels size: levels&quot;</span><span class="p">,</span>
                                          <span class="nb">len</span><span class="p">(</span><span class="n">levels</span><span class="p">),</span> <span class="s2">&quot;labels_mask :&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels_mask</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span> <span class="o">=</span> <span class="n">labels_mask</span><span class="p">[</span><span class="n">idx_levels</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">array_contours</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">])</span> <span class="ow">is</span> <span class="nb">int</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">levels</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;levels&#39;</span><span class="p">]</span>
            <span class="n">liste_intersect</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;alpha0&#39;</span><span class="p">,</span> <span class="s1">&#39;vmin&#39;</span><span class="p">,</span> <span class="s1">&#39;vmax&#39;</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s2">&quot;colors&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">liste_intersect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;cmap&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">liste_intersect</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span> <span class="o">=</span> <span class="n">array_contours</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span> <span class="o">=</span> <span class="n">x_axe</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span> <span class="o">=</span> <span class="n">y_axe</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span> <span class="o">=</span> <span class="n">kwargs</span></div>


<div class="viewcode-block" id="Graphique.polygon">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.polygon">[docs]</a>
    <span class="k">def</span> <span class="nf">polygon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ind</span><span class="p">,</span> <span class="n">alpha</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">facecolor</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;C3&#39;</span><span class="p">,</span> <span class="n">plot_borders</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Plot a uniformly colored polygon</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ind</span>
<span class="sd">            2-dimensional array/list of the coordinate of the polygon characteristics points</span>
<span class="sd">            ind[:, 0] point&#39;s abscissas</span>
<span class="sd">            ind[:, 1] point&#39;s ordinate</span>
<span class="sd">        alpha</span>
<span class="sd">            transparency (between 0 and 1, default 0.7)</span>
<span class="sd">        facecolor</span>
<span class="sd">            Polygon&#39;s color</span>
<span class="sd">        plot_borders</span>
<span class="sd">            If True (default) plot a line at the polygon&#39;s border</span>
<span class="sd">        axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis :</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">        kwargs</span>
<span class="sd">            Extras arguments for matplotlib.patches.PathPatch</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.patches.PathPatch</span>
<span class="sd">            Use to draw the polygon</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axis_config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">alpha</span>
        <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;facecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">facecolor</span>
        <span class="k">if</span> <span class="n">plot_borders</span> <span class="ow">and</span> <span class="s2">&quot;edgecolor&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;edgecolor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">facecolor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_ax">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_ax">[docs]</a>
    <span class="k">def</span> <span class="nf">config_ax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Additionals configurations for ax</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        axis : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;, &quot;all&quot;}, default=&quot;bl&quot;</span>
<span class="sd">            The positions of x-y axis to config:</span>
<span class="sd">                - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">                - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">                - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">                - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>
<span class="sd">                - &quot;all&quot; will configurate aull axis</span>

<span class="sd">        kwargs</span>
<span class="sd">            Keywords available (see matplotlib documentation):</span>
<span class="sd">            - ```sharex```, ```sharey``` Axes, optional</span>
<span class="sd">            The x- or y-axis isshared with the x- or y-axis in the input Axes.</span>
<span class="sd">            Note that it is not possible to unshare axes.</span>
<span class="sd">            - ```frameonbool``` : default=True</span>
<span class="sd">            Whether the Axes frame is visible.</span>
<span class="sd">            - ```box_aspect``` : float, optional</span>
<span class="sd">            Set a fixed aspect for the Axes box,</span>
<span class="sd">            i.e. the ratio of height to width. See set_box_aspect for details.</span>
<span class="sd">            - ```forward_navigation_events``` : bool or &quot;auto&quot;, default: &quot;auto&quot;</span>
<span class="sd">            Control whether pan/zoom events are passed through to Axes below this one. &quot;auto&quot; is True for axes with an</span>
<span class="sd">            invisible patch and False otherwise.</span>
<span class="sd">            - Other optional keyword arguments:</span>
<span class="sd">            -- adjustable {&#39;box&#39;, &#39;datalim&#39;}</span>
<span class="sd">            -- agg_filter : a filter function, which takes a (m, n, 3) float array and a dpi value, and returns</span>
<span class="sd">            a (m, n, 3) array and two offsets from the bottom left corner of the image</span>
<span class="sd">            -- alpha : scalar or None</span>
<span class="sd">            -- anchor : (float, float) or {&#39;C&#39;, &#39;SW&#39;, &#39;S&#39;, &#39;SE&#39;, &#39;E&#39;, &#39;NE&#39;, ...}</span>
<span class="sd">            -- animated : bool</span>
<span class="sd">            -- aspect : {&#39;auto&#39;, &#39;equal&#39;} or float</span>
<span class="sd">            -- autoscale_on : bool</span>
<span class="sd">            -- autoscalex_on</span>
<span class="sd">            -- autoscaley_on</span>
<span class="sd">            -- axes_locator : Callable[[Axes, Renderer], Bbox]</span>
<span class="sd">            -- axisbelow : bool or &#39;line&#39;</span>
<span class="sd">            -- box_aspect : float or None</span>
<span class="sd">            -- clip_on : bool</span>
<span class="sd">            -- facecolor or fc : color</span>
<span class="sd">            -- figure : Figure</span>
<span class="sd">            -- forward_navigation_events : bool or &quot;auto&quot;</span>
<span class="sd">            -- frame_on : bool</span>
<span class="sd">            -- gid : str</span>
<span class="sd">            -- in_layout : bool</span>
<span class="sd">            -- label : object</span>
<span class="sd">            -- mouseover : bool</span>
<span class="sd">            -- navigate : bool</span>
<span class="sd">            -- navigate_mode</span>
<span class="sd">            -- picker : None or bool or float</span>
<span class="sd">            -- position : [left, bottom, width, height]</span>
<span class="sd">            -- rasterization_zorder : float or None</span>
<span class="sd">            -- rasterized : bool</span>
<span class="sd">            -- sketch_params : (scale: float, length: float, randomness: float)</span>
<span class="sd">            -- snap : bool or None</span>
<span class="sd">            -- subplotspec</span>
<span class="sd">            -- title : str</span>
<span class="sd">            -- url : str</span>
<span class="sd">            -- visible : bool</span>
<span class="sd">            -- xbound : (lower: float, upper: float)</span>
<span class="sd">            -- xlabel : str</span>
<span class="sd">            -- xlim : (left: float, right: float)</span>
<span class="sd">            -- xmargin : float greater than -0.5</span>
<span class="sd">            -- xscale</span>
<span class="sd">            -- xticklabels</span>
<span class="sd">            -- xticks</span>
<span class="sd">            -- ybound : (lower: float, upper: float)</span>
<span class="sd">            -- ylabel : str</span>
<span class="sd">            -- ylim : (bottom: float, top: float)</span>
<span class="sd">            -- ymargin : float greater than -0.5</span>
<span class="sd">            -- yscale</span>
<span class="sd">            -- yticklabels</span>
<span class="sd">            -- yticks</span>
<span class="sd">            -- zorder : float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        matplotlib.axes.set</span>
<span class="sd">            The function used with kwargs</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;xticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticks&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticks&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;yticks&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticks&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticks&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticks&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s1">&#39;xticklabels&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticklabels&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;xticklabels&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;yticklabels&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticklabels&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span> <span class="ow">or</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticklabels&#39;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;yticklabels&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;Figure&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;Figure&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;Figure&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;title&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_legende">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_legende">[docs]</a>
    <span class="k">def</span> <span class="nf">config_legende</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To set additionals parameters for the legend plotting</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            additionals parameters for the legend</span>
<span class="sd">            (see https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html)</span>

<span class="sd">            - locstr  default: rcParams[&quot;legend.loc&quot;] (default: &#39;best&#39;)  The location of the legend.</span>
<span class="sd">                The strings &#39;upper left&#39;, &#39;upper right&#39;, &#39;lower left&#39;, &#39;lower right&#39; place the legend at</span>
<span class="sd">                the corresponding corner of the axes.</span>
<span class="sd">                The strings &#39;upper center&#39;, &#39;lower center&#39;, &#39;center left&#39;, &#39;center right&#39; place the</span>
<span class="sd">                legend at the center of the corresponding edge of the axes.</span>
<span class="sd">                The string &#39;center&#39; places the legend at the center of the axes.</span>
<span class="sd">                The string &#39;best&#39; places the legend at the location, among the nine locations defined so far, with the</span>
<span class="sd">                minimum overlap with other drawn artists. This option can be quite slow for plots with large amounts</span>
<span class="sd">                of data; your plotting speed may benefit from providing a specific location.</span>
<span class="sd">                The location can also be a 2-tuple giving the coordinates of the lower-left corner of the legend in</span>
<span class="sd">                axes coordinates (in which case bbox_to_anchor will be ignored).</span>
<span class="sd">                For back-compatibility, &#39;center right&#39; (but no other location) can also be spelled &#39;right&#39;, and each</span>
<span class="sd">                &quot;string&quot; location can also be given as a numeric value:</span>

<span class="sd">            - bbox_to_anchorBboxBase, 2-tuple, or 4-tuple of floats</span>
<span class="sd">                Box that is used to position the legend in conjunction with loc.</span>
<span class="sd">                Defaults to axes.bbox (if called as a method to Axes.legend) or figure.bbox (if Figure.legend).</span>
<span class="sd">                This argument allows arbitrary placement of the legend.</span>
<span class="sd">                Bbox coordinates are interpreted in the coordinate system given by bbox_transform, with the default</span>
<span class="sd">                transform Axes or Figure coordinates, depending on which legend is called.</span>
<span class="sd">                If a 4-tuple or BboxBase is given, then it specifies the bbox (x, y, width, height) that the legend is</span>
<span class="sd">                placed in. To put the legend in the best location in the bottom right quadrant of the Axes (or figure):</span>

<span class="sd">            - loc=&#39;best&#39;, bbox_to_anchor=(0.5, 0., 0.5, 0.5)</span>
<span class="sd">                A 2-tuple (x, y) places the corner of the legend specified by loc at x, y. For example,</span>
<span class="sd">                to put the legend&#39;s upper right-hand corner in the center of the Axes (or figure)</span>
<span class="sd">                the following keywords can be used: loc=&#39;upper right&#39;, bbox_to_anchor=(0.5, 0.5)</span>

<span class="sd">            - ncolsint, default: 1</span>
<span class="sd">                The number of columns that the legend has.</span>
<span class="sd">                For backward compatibility, the spelling ncol is also supported but it is discouraged.</span>
<span class="sd">                If both are given, ncols takes precedence.</span>


<span class="sd">            - fontsize : int or {&#39;xx-small&#39;, &#39;x-small&#39;, &#39;small&#39;, &#39;medium&#39;, &#39;large&#39;, &#39;x-large&#39;, &#39;xx-large&#39;}</span>
<span class="sd">                The font size of the legend. If the value is numeric the size will be the absolute font size in points.</span>
<span class="sd">                String values are relative to the current default font size. This argument is only used if prop</span>
<span class="sd">                is not specified.</span>

<span class="sd">            - labelcolor : str or list, default: rcParams[&quot;legend.labelcolor&quot;] (default: &#39;None&#39;)</span>
<span class="sd">                The color of the text in the legend. Either a valid color string (for example, &#39;red&#39;),</span>
<span class="sd">                or a list of color strings. The labelcolor can also be made to match the color of the line or marker using</span>
<span class="sd">                &#39;linecolor&#39;, &#39;markerfacecolor&#39; (or &#39;mfc&#39;), or &#39;markeredgecolor&#39; (or &#39;mec&#39;).</span>
<span class="sd">                Labelcolor can be set globally using rcParams[&quot;legend.labelcolor&quot;] (default: &#39;None&#39;).</span>
<span class="sd">                If None, use rcParams[&quot;text.color&quot;] (default: &#39;black&#39;).</span>

<span class="sd">            - numpointsint, default: rcParams[&quot;legend.numpoints&quot;] (default: 1)</span>
<span class="sd">                The number of marker points in the legend when creating a legend entry for a Line2D (line).</span>

<span class="sd">            - scatterpointsint, default: rcParams[&quot;legend.scatterpoints&quot;] (default: 1)</span>
<span class="sd">                The number of marker points in the legend when creating a legend entry for a PathCollection (scatter plot).</span>

<span class="sd">            - scatteryoffsets : iterable of floats, default: [0.375, 0.5, 0.3125]</span>
<span class="sd">                The vertical offset (relative to the font size) for the markers created for a scatter plot legend entry.</span>
<span class="sd">                0.0 is at the base the legend text, and 1.0 is at the top. To draw all markers at the same height,</span>
<span class="sd">                set to [0.5].</span>

<span class="sd">            - markerscalefloat, default: rcParams[&quot;legend.markerscale&quot;] (default: 1.0)</span>
<span class="sd">                The relative size of legend markers compared to the originally drawn ones.</span>

<span class="sd">            - markerfirstbool, default: True If True, legend marker is placed to the left of the legend label.</span>
<span class="sd">                If False, legend marker is placed to the right of the legend label.</span>

<span class="sd">            - reversebool, default: False  If True, the legend labels are displayed in reverse order from the input.</span>
<span class="sd">                If False, the legend labels are displayed in the same order as the input.</span>
<span class="sd">                Added in version 3.7.</span>

<span class="sd">            - frameonbool, default: rcParams[&quot;legend.frameon&quot;] (default: True)</span>
<span class="sd">                Whether the legend should be drawn on a patch (frame).</span>

<span class="sd">            - fancyboxbool, default: rcParams[&quot;legend.fancybox&quot;] (default: True)</span>
<span class="sd">                Whether round edges should be enabled around the FancyBboxPatch which makes up the legend&#39;s background.</span>

<span class="sd">            - shadowNone, bool or dict, default: rcParams[&quot;legend.shadow&quot;] (default: False)</span>
<span class="sd">                Whether to draw a shadow behind the legend. The shadow can be configured using Patch keywords.</span>
<span class="sd">                Customization via rcParams[&quot;legend.shadow&quot;] (default: False) is currently not supported.</span>

<span class="sd">            - framealpha float, default: rcParams[&quot;legend.framealpha&quot;] (default: 0.8)</span>
<span class="sd">                The alpha transparency of the legend&#39;s background. If shadow is activated and framealpha is None,</span>
<span class="sd">                the default value is ignored.</span>

<span class="sd">            - facecolor &quot;inherit&quot; or color, default: rcParams[&quot;legend.facecolor&quot;] (default: &#39;inherit&#39;)</span>
<span class="sd">                The legend&#39;s background color. If &quot;inherit&quot;, use rcParams[&quot;axes.facecolor&quot;] (default: &#39;white&#39;).</span>

<span class="sd">            - edgecolor &quot;inherit&quot; or color, default: rcParams[&quot;legend.edgecolor&quot;] (default: &#39;0.8&#39;)</span>
<span class="sd">                The legend&#39;s background patch edge color. If &quot;inherit&quot;, use rcParams[&quot;axes.edgecolor&quot;] (default: &#39;black&#39;).</span>

<span class="sd">            - mode : {&quot;expand&quot;, None}</span>
<span class="sd">                If mode is set to &quot;expand&quot; the legend will be horizontally expanded to fill the Axes area</span>
<span class="sd">                (or bbox_to_anchor if defines the legend&#39;s size).</span>

<span class="sd">            - bbox_transformNone or Transform  The transform for the bounding box (bbox_to_anchor).</span>
<span class="sd">                For a value of None (default) the Axes&#39; transAxes transform will be used.</span>

<span class="sd">            - titlestr or None :  The legend&#39;s title. Default is no title (None).</span>

<span class="sd">            - title_fontproperties : None or FontProperties or dict</span>
<span class="sd">                The font properties of the legend&#39;s title. If None (default), the title_fontsize argument will be used</span>
<span class="sd">                if present; if title_fontsize is also None, the current rcParams[&quot;legend.title_fontsize&quot;]</span>
<span class="sd">                (default: None) will be used.</span>

<span class="sd">            - title_fontsize int or {&#39;xx-small&#39;, &#39;x-small&#39;, &#39;small&#39;, &#39;medium&#39;, &#39;large&#39;, &#39;x-large&#39;, &#39;xx-large&#39;},</span>
<span class="sd">                default: rcParams[&quot;legend.title_fontsize&quot;] (default: None)</span>
<span class="sd">                The font size of the legend&#39;s title. Note: This cannot be combined with title_fontproperties.</span>
<span class="sd">                If you want to set the fontsize alongside other font properties, use the size parameter</span>
<span class="sd">                in title_fontproperties.</span>

<span class="sd">            - alignment{&#39;center&#39;, &#39;left&#39;, &#39;right&#39;}, default: &#39;center&#39;</span>
<span class="sd">                The alignment of the legend title and the box of entries. The entries are aligned as a single block,</span>
<span class="sd">                so that markers always lined up.</span>

<span class="sd">            - borderpad float, default: rcParams[&quot;legend.borderpad&quot;] (default: 0.4)</span>
<span class="sd">                The fractional whitespace inside the legend border, in font-size units.</span>

<span class="sd">            - labelspacing  float, default: rcParams[&quot;legend.labelspacing&quot;] (default: 0.5)</span>
<span class="sd">                The vertical space between the legend entries, in font-size units.</span>

<span class="sd">            - handlelength float, default: rcParams[&quot;legend.handlelength&quot;] (default: 2.0)</span>
<span class="sd">                The length of the legend handles, in font-size units.</span>

<span class="sd">            - handleheight float, default: rcParams[&quot;legend.handleheight&quot;] (default: 0.7)</span>
<span class="sd">                The height of the legend handles, in font-size units.</span>

<span class="sd">            - handletextpad float, default: rcParams[&quot;legend.handletextpad&quot;] (default: 0.8)</span>
<span class="sd">                The pad between the legend handle and text, in font-size units.</span>

<span class="sd">            - borderaxespad float, default: rcParams[&quot;legend.borderaxespad&quot;] (default: 0.5)</span>
<span class="sd">                The pad between the Axes and legend border, in font-size units.</span>

<span class="sd">            - columnspacing float, default: rcParams[&quot;legend.columnspacing&quot;] (default: 2.0)</span>
<span class="sd">                The spacing between columns, in font-size units.</span>

<span class="sd">            - draggablebool, default: False</span>
<span class="sd">                Whether the legend can be dragged with the mouse.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.pyplot.legend</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_labels_contours">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_labels_contours">[docs]</a>
    <span class="k">def</span> <span class="nf">config_labels_contours</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        </span>
<span class="sd">        Additionals configurations for the contours labels</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            </span>
<span class="sd">            - fontsize str or float, default: rcParams[&quot;font.size&quot;] (default: 10.0)</span>
<span class="sd">                Size in points or relative size e.g., &#39;smaller&#39;, &#39;x-large&#39;.</span>
<span class="sd">                See plt.Text.set_size for accepted string values.</span>

<span class="sd">            - colorscolor or colors or None, default: None</span>
<span class="sd">                The label colors:</span>

<span class="sd">                    If None, the color of each label matches the color of the corresponding contour.</span>

<span class="sd">                    If one string color, e.g., colors = &#39;r&#39; or colors = &#39;red&#39;, all labels will be plotted in this color.</span>

<span class="sd">                    If a tuple of colors (string, float, RGB, etc), different labels will be plotted in different</span>
<span class="sd">                     colors in the order specified.</span>

<span class="sd">            - inlinebool, default: True</span>
<span class="sd">                If True the underlying contour is removed where the label is placed.</span>

<span class="sd">            - inline_spacingfloat, default: 5</span>
<span class="sd">                Space in pixels to leave on each side of label when placing inline.</span>
<span class="sd">                This spacing will be exact for labels at locations where the contour is straight, less so for labels on</span>
<span class="sd">                curved contours.</span>

<span class="sd">            - fmt str, optional</span>
<span class="sd">                How the levels are formatted:  it is interpreted as a %-style format string.</span>
<span class="sd">                The default is to use a standard ScalarFormatter.</span>

<span class="sd">            - manual bool or iterable, default: False</span>
<span class="sd">                If True, contour labels will be placed manually using mouse clicks. Click the first button near a</span>
<span class="sd">                contour to add a label, click the second button (or potentially both mouse buttons at once) to finish</span>
<span class="sd">                adding labels. The third button can be used to remove the last label added, but only if labels are not</span>
<span class="sd">                inline. Alternatively, the keyboard can be used to select label locations (enter to end label</span>
<span class="sd">                placement, delete or backspace act like the third mouse button, and any other key will select a label</span>
<span class="sd">                location).</span>
<span class="sd">                manual can also be an iterable object of (x, y) tuples. Contour labels will be created as if mouse is</span>
<span class="sd">                clicked at each (x, y) position.</span>

<span class="sd">            - rightside_upbool, default: True</span>
<span class="sd">                If True, label rotations will always be plus or minus 90 degrees from level.</span>

<span class="sd">            - use_clabeltext bool, default: False</span>
<span class="sd">                If True, use Text.set_transform_rotates_text to ensure that label rotation is updated whenever the Axes</span>
<span class="sd">                aspect changes.</span>

<span class="sd">            - zorder float or None, default: (2 + contour.get_zorder())</span>
<span class="sd">                zorder of the contour labels.</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        </span>
<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.axes.Axes.clabel</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_fig">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_fig">[docs]</a>
    <span class="k">def</span> <span class="nf">config_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Additionnals parameters to configure the Figure</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            - figsize2 : tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>
<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>
<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>
<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>
<span class="sd">            - linewidthfloat</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameonbool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes decorations.</span>
<span class="sd">                    Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                     fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the subplot</span>
<span class="sd">                    parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                    more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                    provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their config</span>
<span class="sd">                defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and rcParams[&quot;figure.constrained_layout.use&quot;]</span>
<span class="sd">                (default: False).</span>

<span class="sd">            - alpha scalar or None</span>

<span class="sd">            - animated bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - layout_engine  {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float or callable</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches  (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        matplotlib.pyplot.Figure</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_enrg_fig">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_enrg_fig">[docs]</a>
    <span class="k">def</span> <span class="nf">config_enrg_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Additionals parameters for the Figure saving</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>

<span class="sd">            - figsize 2-tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>

<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>

<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>

<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>

<span class="sd">            - linewidth float</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameon bool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;onstrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes</span>
<span class="sd">                     decorations. Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                    fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the</span>
<span class="sd">                     subplot parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                     more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                      provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their</span>
<span class="sd">                 config defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and</span>
<span class="sd">                 rcParams[&quot;figure.constrained_layout.use&quot;] (default: False).</span>

<span class="sd">            - alpha  scalar or None</span>

<span class="sd">            - animated  bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout  unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor  color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - label object</span>

<span class="sd">            - layout_engine {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout unknown</span>

<span class="sd">            - transform  Transform</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        matplotlib.figure.Figure.savefig</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_font">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_font">[docs]</a>
    <span class="k">def</span> <span class="nf">config_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Global font parameter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            &#39;family&#39; : &#39;fantasy&#39;,&#39;monospace&#39;,&#39;sans-serif&#39;,&#39;serif&#39;,&#39;cursive&#39;</span>
<span class="sd">            &#39;styles&#39; : &#39;normal&#39;, &#39;italic&#39;, &#39;oblique&#39;</span>
<span class="sd">            &#39;size&#39; : valeur numérique</span>
<span class="sd">            &#39;variants&#39; : &#39;normal&#39;, &#39;small-caps&#39;</span>
<span class="sd">            &#39;weight&#39; : &#39;light&#39;, &#39;normal&#39;, &#39;medium&#39;, &#39;semibold&#39;, &#39;bold&#39;, &#39;heavy&#39;, &#39;black&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;font.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;font.&#39;</span> <span class="o">+</span> <span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.config_colorbar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.config_colorbar">[docs]</a>
    <span class="k">def</span> <span class="nf">config_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index_colorbar</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ii_max</span><span class="p">,</span> <span class="n">ticks</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                        <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Colorbar additianal parameter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index_colorbar : int, optional</span>
<span class="sd">            The index of the colorbar (default the parameters are added for all colorbars)</span>
<span class="sd">        ticks : list[float] | array_like</span>
<span class="sd">            The colorbar&#39;s ticks. If None, ticks are determined automatically from the input.</span>
<span class="sd">        kwargs</span>
<span class="sd">            the parameter dictionary</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">index_colorbar</span> <span class="o">==</span> <span class="n">ii_max</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">:</span>
                <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span> <span class="o">=</span> <span class="p">[</span><span class="n">ticks</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span> <span class="o">=</span> <span class="p">[[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">index_colorbar</span><span class="p">]</span> <span class="o">=</span> <span class="n">ticks</span>
            <span class="k">elif</span> <span class="n">ticks</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">index_colorbar</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">index_colorbar</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.dark_background">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.dark_background">[docs]</a>
    <span class="k">def</span> <span class="nf">dark_background</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Put a dark background on the figure</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>

<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;dark_background&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;k&quot;</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;k&quot;</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;k&quot;</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;w&quot;</span></div>


<div class="viewcode-block" id="Graphique.default_style">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.default_style">[docs]</a>
    <span class="k">def</span> <span class="nf">default_style</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Use default style</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">):</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;colors&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">])):</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span>
        <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;facecolor&quot;</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;w&quot;</span><span class="p">:</span>
                <span class="n">d</span><span class="p">[</span><span class="s2">&quot;facecolor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;k&quot;</span></div>


<div class="viewcode-block" id="Graphique.plot_colorbar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_colorbar">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_colorbar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the custom colorbar(s) if it(they) exists</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># share_axis: np.array[int] = np.full(len(self.custum_colorbar_colors), -1)</span>
            <span class="n">right</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sr</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">top</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">st</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">left</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sl</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">bottom</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">sb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="n">size_colorbar</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.02</span>
            <span class="n">size_legend</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">size_colorbar</span>
            <span class="n">size_space</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">)):</span>
                <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;hide&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;right&quot;</span><span class="p">:</span>
                        <span class="n">right</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sr</span> <span class="o">+=</span> <span class="n">size_colorbar</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;share_axis&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">size_legend</span> <span class="o">/</span> <span class="n">size_colorbar</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">sr</span> <span class="o">+=</span> <span class="n">size_legend</span>
                        <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sr</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;top&quot;</span><span class="p">:</span>
                        <span class="n">top</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">st</span> <span class="o">+=</span> <span class="n">size_colorbar</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;share_axis&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">size_legend</span> <span class="o">/</span> <span class="n">size_colorbar</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">st</span> <span class="o">+=</span> <span class="n">size_legend</span>
                        <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">st</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                        <span class="n">left</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sl</span> <span class="o">+=</span> <span class="n">size_colorbar</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;share_axis&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">size_legend</span> <span class="o">/</span> <span class="n">size_colorbar</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">sl</span> <span class="o">+=</span> <span class="n">size_legend</span>
                        <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sl</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bottom&quot;</span><span class="p">:</span>
                        <span class="n">bottom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sb</span> <span class="o">+=</span> <span class="n">size_colorbar</span>
                        <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;share_axis&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]):</span>
                            <span class="k">if</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">size_legend</span> <span class="o">/</span> <span class="n">size_colorbar</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">sb</span> <span class="o">+=</span> <span class="n">size_legend</span>
                        <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                            <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">sb</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Graphique.plot_colorbar : the location &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s2">&quot;location&quot;</span><span class="p">],</span>
                                          <span class="s2">&quot;isn&#39;t awalible. Please use right, top, left, bottom&quot;</span><span class="p">)</span>

            <span class="n">pos_r</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">pos_t</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">1.</span>
            <span class="n">pos_l</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">pos_b</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">right</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">))):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
                <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]</span>
                    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                    <span class="n">ticks_labels</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks_labels&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                    <span class="n">share_axis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="s2">&quot;share_axis&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">share_axis</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>
                    <span class="n">fraction</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="s2">&quot;fraction&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fraction</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>

                    <span class="n">size_cb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_colorbar</span>
                    <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size_cb</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                    <span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_cb</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_axis</span> <span class="ow">and</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_legend</span>
                    <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="n">pos_r</span> <span class="o">-</span> <span class="n">size</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">fraction</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span>
                                              <span class="n">size_cb</span><span class="p">,</span> <span class="n">fraction</span><span class="p">])</span>
                    <span class="c1"># cax = self.fig.add_axes([pos_r - size, 0.5 - fraction / 2.,</span>
                    <span class="c1">#                           size_cb, fraction])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
                    <span class="n">pos_r</span> <span class="o">-=</span> <span class="n">size</span>
                    <span class="c1"># cax.set_xticks([])</span>
                    <span class="c1"># cax.set_yticks([])</span>
                    <span class="c1"># cax.set_axis_off()</span>

                    <span class="c1"># if share_axis:</span>
                    <span class="c1">#     cax.sharey = self.colorbar[-1].ax</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">),</span>
                                                           <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">scale</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">ticks_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
                          <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">ticks_labels</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">top</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">))):</span>
                <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
                <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]</span>
                    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                    <span class="n">ticks_labels</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks_labels&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                    <span class="n">share_axis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="s2">&quot;share_axis&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">share_axis</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>

                    <span class="n">fraction</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mf">1.</span>
                    <span class="k">if</span> <span class="s2">&quot;fraction&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fraction</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>

                    <span class="n">size_cb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_colorbar</span>
                    <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size_cb</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                    <span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_cb</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_axis</span> <span class="ow">and</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_legend</span>
                    <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">fraction</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">pos_t</span> <span class="o">-</span> <span class="n">size</span><span class="p">,</span>
                                              <span class="n">fraction</span><span class="p">,</span> <span class="n">size_cb</span><span class="p">])</span>
                    <span class="c1"># cax = self.fig.add_axes([0.5 - fraction / 2., pos_t - size,</span>
                    <span class="c1">#                           fraction, size_cb])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
                    <span class="n">pos_t</span> <span class="o">-=</span> <span class="n">size</span>
                    <span class="c1"># cax.set_xticks([])</span>
                    <span class="c1"># cax.set_yticks([])</span>
                    <span class="c1"># cax.set_axis_off()</span>

                    <span class="c1"># if share_axis:</span>
                    <span class="c1">#     cax.sharey = self.colorbar[-1].ax</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">),</span>
                                                           <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">scale</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">ticks_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
                          <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">ticks_labels</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>

                <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">))):</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
                    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                    <span class="n">ticks_labels</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks_labels&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span>
                        <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                    <span class="n">share_axis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="s2">&quot;share_axis&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">share_axis</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>

                    <span class="n">fraction</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="s2">&quot;fraction&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fraction</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>

                    <span class="n">size_cb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_colorbar</span>
                    <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size_cb</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                    <span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_cb</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_axis</span> <span class="ow">and</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_legend</span>

                    <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_space</span>

                    <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="n">pos_l</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="n">fraction</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">size_cb</span><span class="p">,</span> <span class="n">fraction</span><span class="p">])</span>
                    <span class="c1"># cax = self.fig.add_axes([pos_l, 0.5 - fraction / 2., size_cb, fraction])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
                    <span class="n">pos_l</span> <span class="o">+=</span> <span class="n">size</span>
                    <span class="c1"># cax.set_xticks([])</span>
                    <span class="c1"># cax.set_yticks([])</span>
                    <span class="c1"># cax.set_axis_off()</span>

                    <span class="c1"># if share_axis:</span>
                    <span class="c1">#     cax.sharey = self.colorbar[-1].ax</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">),</span>
                                                           <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">scale</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">ticks_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
                          <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">ticks_labels</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">ii</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">bottom</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">))):</span>

                <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="s2">&quot;hide&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;hide&quot;</span><span class="p">]</span>
                    <span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">ListedColormap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span>
                    <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;format&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fmt</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">]</span>
                    <span class="n">ticks_labels</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;ticks_labels&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;ticks_labels&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="n">fmt</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="n">ticks_labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
                    <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>
                    <span class="k">if</span> <span class="s2">&quot;scale&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">scale</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;scale&quot;</span><span class="p">]</span>
                    <span class="n">share_axis</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="s2">&quot;share_axis&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">share_axis</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;share_axis&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span>

                    <span class="n">fraction</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">double</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
                    <span class="k">if</span> <span class="s2">&quot;fraction&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">fraction</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;fraction&quot;</span><span class="p">]</span>

                    <span class="n">size_cb</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_colorbar</span>
                    <span class="k">if</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size_cb</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">]</span>
                    <span class="n">size</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span> <span class="o">=</span> <span class="n">size_cb</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">share_axis</span> <span class="ow">and</span> <span class="s2">&quot;size_legend&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;size_legend&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_legend</span>
                    <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">share_axis</span><span class="p">:</span>
                        <span class="n">size</span> <span class="o">+=</span> <span class="n">size_space</span>
                    <span class="n">cax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="mf">0.5</span> <span class="o">-</span> <span class="n">fraction</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">pos_b</span><span class="p">,</span> <span class="n">size_cb</span><span class="p">,</span> <span class="n">fraction</span><span class="p">])</span>
                    <span class="c1"># cax = self.fig.add_axes([0.5 - fraction / 2., pos_b, size_cb, fraction])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cax</span><span class="p">)</span>
                    <span class="n">pos_b</span> <span class="o">+=</span> <span class="n">size</span>
                    <span class="c1"># cax.set_xticks([])</span>
                    <span class="c1"># cax.set_yticks([])</span>
                    <span class="c1"># cax.set_axis_off()</span>

                    <span class="c1"># if share_axis:</span>
                    <span class="c1">#     cax.sharey = self.colorbar[-1].ax</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">),</span>
                                                           <span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmap</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">norm</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">scale</span> <span class="o">!=</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="n">scale</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="p">(</span><span class="n">ticks_labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span>
                          <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">ticks_labels</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ticks_colorbar</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">colorbar</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ticks</span><span class="o">=</span><span class="p">[])</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">right</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sr</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">right</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sr</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">top</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">st</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">top</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">st</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mf">2.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">left</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="n">pos_l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sl</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                    <span class="n">pos_l</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">left</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sl</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="n">pos_l</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bottom</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;space_between&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                    <span class="n">pos_b</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;space_between&quot;</span><span class="p">]</span>
                <span class="k">elif</span> <span class="s2">&quot;size&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">sb</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                    <span class="n">pos_b</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_colorbar</span><span class="p">[</span><span class="n">bottom</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s2">&quot;size&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sb</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mi">2</span>
                    <span class="n">pos_b</span> <span class="o">+=</span> <span class="n">size_colorbar</span> <span class="o">/</span> <span class="mi">2</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_navigate</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">new_ax_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">inset_axes</span><span class="p">([</span><span class="n">pos_l</span><span class="p">,</span> <span class="n">pos_b</span><span class="p">,</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span><span class="n">sl</span> <span class="o">+</span> <span class="n">sr</span><span class="p">),</span> <span class="mf">1.</span> <span class="o">-</span> <span class="p">(</span><span class="n">st</span> <span class="o">+</span> <span class="n">sb</span><span class="p">)])</span>
            <span class="n">new_ax_</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
            <span class="n">new_ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">new_ax_</span><span class="o">.</span><span class="n">get_position</span><span class="p">())</span>
            <span class="c1"># new_ax = self.fig.add_axes([pos_l, pos_b, 1. - (sl + sr), 1. - (st + sb)])</span>
            <span class="n">new_ax</span><span class="o">.</span><span class="n">set_navigate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_ax</span><span class="p">)</span>
            <span class="n">new_ax</span><span class="o">.</span><span class="n">sharex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
            <span class="n">new_ax</span><span class="o">.</span><span class="n">sharey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">new_ax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_navigate</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_lines">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_lines">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot all the line of the Graphique</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="n">index</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">params_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params_i</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                        <span class="k">del</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="n">err_x</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">err_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">err_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><span class="n">err_x</span><span class="p">,</span>
                                <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><span class="n">err_x</span><span class="p">,</span>
                                <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><span class="n">err_x</span><span class="p">,</span>
                                <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span>
                                <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">xerr</span><span class="o">=</span><span class="n">err_x</span><span class="p">,</span>
                                <span class="n">yerr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">err_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">if</span> <span class="s2">&quot;color&quot;</span> <span class="ow">in</span> <span class="n">params_i</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">],</span>
                                                              <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
                            <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                            <span class="k">if</span> <span class="s2">&quot;marker&quot;</span> <span class="ow">in</span> <span class="n">params_i</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                                <span class="n">marker</span> <span class="o">=</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span>
                                <span class="k">del</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;marker&quot;</span><span class="p">]</span>

                            <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>

                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="s2">&quot;linestyle&quot;</span> <span class="ow">in</span> <span class="n">params_i</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">or</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;linestyle&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                                <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]]</span>

                                <span class="k">del</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;color&quot;</span><span class="p">]</span>
                                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                                    <span class="n">colored_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                                    <span class="n">colored_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                                    <span class="n">colored_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;tr&quot;</span>
                                    <span class="n">colored_line</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">colors</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="p">,</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>

                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                            <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="c1"># bl, default axis</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

                <span class="c1"># tl</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

                <span class="c1"># tr</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

                <span class="c1"># br</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_texts">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_texts">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_texts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot all the texts of the Graphique</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">)):</span>
                <span class="c1"># for (X, Y, S) in zip(self.lines_t_x[i], self.lines_t_y[i], self.lines_t_s[i]):</span>
                <span class="n">params_i</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_texts</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">params_i</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">params_i</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config=&quot;bl&quot;</span>
                    <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span>
                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">lines_t_s</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="o">**</span><span class="n">params_i</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_histogrammes">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_histogrammes">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_histogrammes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the Graphique&#39;s histogramme (if there is one)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="c1"># Axe creation</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="c1"># plotting histogrammes</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">)):</span>
                <span class="n">pos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">largeur</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bords_histogramme</span><span class="p">[</span><span class="n">i</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">largeur</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">,</span>
                                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
                        <span class="n">x</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="n">largeur</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;edge&#39;</span><span class="p">)</span>
            <span class="c1"># axes coordinate configuration</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">))]):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_image">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_image">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_image</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the Graphique&#39;s image (if there is one)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="n">params_tableau</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">params_tableau</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">params_tableau</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">params_tableau</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># bl</span>
                <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">,</span>
                                   <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span>
                                   <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                   <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                   <span class="o">**</span><span class="n">params_tableau</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span>
                                      <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="o">**</span><span class="n">params_tableau</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span>
                                      <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="o">**</span><span class="n">params_tableau</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span>
                                      <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cmap</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="n">norm</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">norms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index_colorbar_image</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span>
                                      <span class="o">**</span><span class="n">params_tableau</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_contours">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_contours">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_contours</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the Graphique&#39;s contours (if there are)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;colors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">color_label_contours</span>
        <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
            <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># bl</span>
            <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span>

        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span>  <span class="c1"># print(&quot;levels&quot;,levels)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">levels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nb_contours</span>  <span class="c1"># print(&quot;levels&quot;,levels)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">x_axe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">x_axe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe_image</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="n">y_axe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span>
                        <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                        <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">y_axe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_image</span>
                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x_axe</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x_axe</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x_axe</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">x_axe</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span><span class="p">,</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">dic_labels</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">):</span>
                            <span class="n">dic_labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span>
                                           <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">dic_labels</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">):</span>
                            <span class="n">dic_labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span>
                                              <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">dic_labels</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">):</span>
                            <span class="n">dic_labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span>
                                              <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="n">cs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe_contours</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe_contours</span><span class="p">,</span>
                                            <span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">dic_labels</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
                        <span class="k">for</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">clabels</span><span class="p">):</span>
                            <span class="n">dic_labels</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">clabels_mask</span><span class="p">],</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span>
                                              <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">levels</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">dic_labels</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">clabel</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_labels_contours</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot_polygones">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot_polygones">[docs]</a>
    <span class="k">def</span> <span class="nf">plot_polygones</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the Graphique&#39;s polygones (if there are)</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="p">)):</span>
                <span class="n">params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                    <span class="k">del</span> <span class="n">params</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># bl</span>
                    <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span>
                <span class="n">P</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">poly</span> <span class="o">=</span> <span class="n">PathPatch</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">axis_config</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># axis_config == &quot;br&quot;</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">poly</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.plot">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.plot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_Multigraph</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot all the Graphique&#39;s elements</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_Multigraph: bool, optional, default=False</span>
<span class="sd">            If the Graphique is plotted in a Multigraph, it deactivate globals parameters such as</span>
<span class="sd">            the police or the style.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">param_font</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">in_Multigraph</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The style &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="s2">&quot; is not awalible. </span><span class="se">\n</span><span class="s2"> Plese use :</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;dark_background&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dark_background</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_style</span><span class="p">()</span>
            <span class="n">param_font</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span>
        <span class="k">with</span> <span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">param_font</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">[</span><span class="s2">&quot;projection&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="p">]</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">custum_colorbar_colors</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_colorbar</span><span class="p">()</span>

            <span class="n">index</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indexs_plot_lines</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                                 <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                         <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                         <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                         <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                                    <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">]))):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tl</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                                 <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                         <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                         <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                         <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                                    <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">]))):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_br</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="ow">is</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                            <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                    <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_image</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                    <span class="ow">or</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_contours</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                               <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">]))):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax_tr</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_ax</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">if</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">args</span><span class="p">[</span><span class="s2">&quot;projection&quot;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                   
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_x_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y_axe</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;empty&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels_y_ticks</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_lines</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals_histogramme</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_histogrammes</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_image</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_contours</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tab_contours_is_image</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">array_image</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_contours</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">index_polygons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_polygones</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lines_t_x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_texts</span><span class="p">()</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                                   <span class="ow">or</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="p">(</span><span class="s2">&quot;axis_config&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                                                          <span class="ow">or</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;bl&quot;</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">])):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                        <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tl&quot;</span>
                               <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">])):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                        <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;tr&quot;</span>
                               <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">])):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                        <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_lines</span><span class="p">)[</span><span class="n">index</span><span class="p">]])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span> <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_histogrammes</span><span class="p">])</span>
                    <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">([</span><span class="s2">&quot;label&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="s2">&quot;axis_config&quot;</span> <span class="ow">in</span> <span class="n">dic</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="ow">and</span> <span class="n">dic</span><span class="p">[</span><span class="s2">&quot;axis_config&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;br&quot;</span>
                               <span class="k">for</span> <span class="n">dic</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_polygons</span><span class="p">])):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_legende</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">)</span></div>


<div class="viewcode-block" id="Graphique.save_figure">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.save_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">save_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the image product by the Graphique&#39;s plotting, not the Graphique itself.</span>
<span class="sd">        The image is saved on the Graphiqu&#39;s format (default .png)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args</span>
<span class="sd">            Additionals parameters for the Figure saving</span>
<span class="sd">            see https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.savefig.html#matplotlib.figure.Figure.savefig</span>

<span class="sd">            - figsize 2-tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>

<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>

<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>

<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>

<span class="sd">            - linewidth float</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameon bool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;onstrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes</span>
<span class="sd">                     decorations. Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                    fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the</span>
<span class="sd">                     subplot parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                     more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                      provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their</span>
<span class="sd">                 config defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and</span>
<span class="sd">                 rcParams[&quot;figure.constrained_layout.use&quot;] (default: False).</span>

<span class="sd">            - alpha  scalar or None</span>

<span class="sd">            - animated  bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout  unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor  color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - label object</span>

<span class="sd">            - layout_engine {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout unknown</span>

<span class="sd">            - transform  Transform</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args_enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">args_enrg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">,</span> <span class="o">**</span><span class="n">args_enrg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Graphique.show">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Graphique.show">[docs]</a>
    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the Graphique</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># plt.ion()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tl</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_tr</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax_br</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span></div>
</div>



<span class="c1"># ---------------------------------------------------------------------------</span>
<span class="c1"># ---------------------------- Graphique building ---------------------------</span>
<span class="c1"># ---------------------------------------------------------------------------</span>


<div class="viewcode-block" id="line">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.line">[docs]</a>
<span class="k">def</span> <span class="nf">line</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
         <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to plt.plot</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar : optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The coresponding new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```self.line(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```plt.plot(x, y1, *args)</span>
<span class="sd">            plt.plot(x, y2, *args)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```line([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```line((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to :</span>
<span class="sd">            ```plt.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            plt.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(0, 10, 1000)</span>
<span class="sd">    &gt;&gt;&gt; alpha = np.linspace(1, 5, 10)</span>
<span class="sd">    &gt;&gt;&gt; colors = linear_color_interpolation(np.arange(len(alpha)), col_min=g.C1, col_max=g.C2)</span>
<span class="sd">    &gt;&gt;&gt; gr = line(x, [x*a for a in alpha], color=colors)</span>
<span class="sd">    &gt;&gt;&gt; gr.customized_cmap(alpha, colors)</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
               <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="errorbar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.errorbar">[docs]</a>
<span class="k">def</span> <span class="nf">errorbar</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">err_y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
             <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to plt.errorbar</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : list | array_like</span>
<span class="sd">        Abscissa</span>
<span class="sd">    y : list | array_like</span>
<span class="sd">        Ordinate</span>
<span class="sd">    err_y : list | array_like</span>
<span class="sd">        Error associated with y</span>
<span class="sd">    err_x : list | array_like</span>
<span class="sd">        Error associated with x</span>
<span class="sd">    marker : list[str] | array_like[str], str, optional, default=&quot;&quot;</span>
<span class="sd">        The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">        see matplotlib documentation for all the possibility</span>
<span class="sd">    scale : str, optional, default=&quot;linear&quot;</span>
<span class="sd">        The scales of (x, y) axis :</span>
<span class="sd">        - default : &quot;&quot; (linear scale for both x and y)</span>
<span class="sd">        - polar : polar projection : X=r and Y=theta</span>
<span class="sd">        - loglog, logx, logy : Logarithmic scale for both, x or y axis</span>
<span class="sd">        - symloglog, symlogx, symlogy : Logarithmic scale for both, x or y axis with positive and négative values</span>

<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide: bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">err_y</span><span class="o">=</span><span class="n">err_y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="errorplot">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.errorplot">[docs]</a>
<span class="k">def</span> <span class="nf">errorplot</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">err_y</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
              <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to plt.errorbar but the error is not represented by errorbars but by a</span>
<span class="sd">    uniform-colored polygon</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : list | array_like</span>
<span class="sd">        Abscissa</span>
<span class="sd">    y : list | array_like</span>
<span class="sd">        Ordinate</span>
<span class="sd">    err_y : list | array_like</span>
<span class="sd">        Error associated with y</span>
<span class="sd">    marker : list[str] | array_like[str], str, optional, default=&quot;&quot;</span>
<span class="sd">        The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">        see matplotlib documentation for all the possibility</span>
<span class="sd">    scale : str, optional, default=&quot;linear&quot;</span>
<span class="sd">        The scales of (x, y) axis :</span>
<span class="sd">        - default : &quot;&quot; (linear scale for both x and y)</span>
<span class="sd">        - polar : polar projection : X=r and Y=theta</span>
<span class="sd">        - loglog, logx, logy : Logarithmic scale for both, x or y axis</span>
<span class="sd">        - symloglog, symlogx, symlogy : Logarithmic scale for both, x or y axis with positive and négative values</span>

<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide: bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>


<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">errorplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">err_y</span><span class="o">=</span><span class="n">err_y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="polar">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.polar">[docs]</a>
<span class="k">def</span> <span class="nf">polar</span><span class="p">(</span><span class="n">r</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">theta</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
          <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
          <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line in polar projection</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    r : list | array_like</span>
<span class="sd">        Radius</span>
<span class="sd">    theta : list | array_like</span>
<span class="sd">        Angle(s)</span>
<span class="sd">    z : list | array_like, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker:  : list[str] | array_like, str, optional, default=&quot;&quot;</span>
<span class="sd">        The marker (ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;...)</span>
<span class="sd">        see matplotlib documentation for all the possibility</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True(default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z: str, optional, {&quot;linear&quot;, &quot;log&quot;, &quot;symlog&quot;}, default=&quot;linear&quot;</span>
<span class="sd">        The scale of the z-axis (linear (default), log, symplog)</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar: dict</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs</span>
<span class="sd">        Additional argument to plot() function like linestyle, color...</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    The order of first and second arguments is opposit to the matplotlib one :</span>
<span class="sd">    The first argument is the radius, then the angle</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="loglog">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.loglog">[docs]</a>
<span class="k">def</span> <span class="nf">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
           <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
           <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line with a logarithmique scale for both x and y-axis:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```loglog(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```plt.loglog(x, y1, *args)</span>
<span class="sd">            plt.loglog(x, y2, *args)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```loglog([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```loglog((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```plt.loglog(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            plt.loglog(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(0, 10, 1000)</span>
<span class="sd">    &gt;&gt;&gt; alpha = np.linspace(1, 5, 10)</span>
<span class="sd">    &gt;&gt;&gt; colors = linear_color_interpolation(np.arange(len(alpha)), col_min=g.C1, col_max=g.C2)</span>
<span class="sd">    &gt;&gt;&gt; gr: Graphique = loglog(x, [x*a for a in alpha], color=colors)</span>
<span class="sd">    &gt;&gt;&gt; gr.customized_cmap(alpha, colors)</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                 <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="symloglog">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.symloglog">[docs]</a>
<span class="k">def</span> <span class="nf">symloglog</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
              <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line with a logarithmique scale for both x and y-axis</span>
<span class="sd">    Both the negative and positive parts of y are represanted:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```symloglog(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, *args)</span>
<span class="sd">            ax.plot(x, y2, *args)</span>
<span class="sd">            ax.set(xscale=&quot;symlog&quot;, yscale=&quot;symlog&quot;)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```symloglog([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```symloglog((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">            ax.set(xscale=&quot;symlog&quot;, yscale=&quot;symlog&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(-10, 10, 1000)</span>
<span class="sd">    &gt;&gt;&gt; gr = symloglog(x, np.tan(x))</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">symloglog</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                    <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="logx">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.logx">[docs]</a>
<span class="k">def</span> <span class="nf">logx</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
         <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line with a logarithmique scale for x-axis:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```logx(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, *args)</span>
<span class="sd">            ax.plot(x, y2, *args)</span>
<span class="sd">            ax.set(scale=&quot;log&quot;)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```logx([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```logx((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">            ax.set(xscale=&quot;log&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.logspace(-10, 10, 1000)</span>
<span class="sd">    &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">    &gt;&gt;&gt; gr.logx(x, np.arctan(x))</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">logx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
               <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="symlogx">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.symlogx">[docs]</a>
<span class="k">def</span> <span class="nf">symlogx</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line with a logarithmique scale for both x-axis (both negative and positive</span>
<span class="sd">    part are represanted):</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```symlogx(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, *args)</span>
<span class="sd">            ax.plot(x, y2, *args)</span>
<span class="sd">            ax.set(xscale=&quot;symlog&quot;)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```symlogx([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```symlogx((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">            ax.set(xscale=&quot;symlog&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.append(-np.logspace(10, -10, 1000), np.logspace(-10, 10, 1000))</span>
<span class="sd">    &gt;&gt;&gt; gr = Graphique()</span>
<span class="sd">    &gt;&gt;&gt; gr.symlogx(x, np.arctan(x))</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">symlogx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="logy">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.logy">[docs]</a>
<span class="k">def</span> <span class="nf">logy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
         <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
         <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Equivalent to line with a logarithmique scale for y-axis:</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">        z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">        If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">        even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logx : Graphique.line in log coordinate for x axis and linear for y axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogy : Similar to Graphique.logy but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```logy(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, *args)</span>
<span class="sd">            ax.plot(x, y2, *args)</span>
<span class="sd">            ax.set(yscale=&quot;log&quot;)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```logy([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```logy((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;]```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">            ax.set(yscale=&quot;log&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.logspace(-10, 10, 1000)</span>
<span class="sd">    &gt;&gt;&gt; gr = logy(x, np.arctan(x))</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">logy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
               <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="symlogy">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.symlogy">[docs]</a>
<span class="k">def</span> <span class="nf">symlogy</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">z</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
            <span class="n">scale_z</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hide</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to line with a logarithmique scale for y-axis (both positive and negative</span>
<span class="sd">    part are represanted):</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : array_like | list</span>
<span class="sd">        Abscissa(s)</span>
<span class="sd">    y : array_like | list, optional</span>
<span class="sd">        Ordinate(s), if None x became the ordinate and the abscissa is arange(len(x))</span>
<span class="sd">    z : array_like | list, optional</span>
<span class="sd">         z-axis (represented by a colorscale)</span>
<span class="sd">    marker : str | list[str] | array_like[str], optional, default=&quot;&quot;</span>
<span class="sd">        The marker  ex &quot;.&quot;, &quot;,&quot;, &quot;o&quot;, &quot;v&quot;... (see matplotlib documentation)</span>
<span class="sd">    share_colorbar : bool, optional, default=True</span>
<span class="sd">         If True (default) and z is not None, only one colorscale is used</span>
<span class="sd">         even if z is in two dimensions</span>
<span class="sd">    scale_z : str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}, optional, default=&#39;linear&#39;</span>
<span class="sd">        The scale of the z-axis</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    hide : bool, optional, default=False</span>
<span class="sd">        If True then the new line(s) is/are not plotted with the Graphique.</span>
<span class="sd">        To plot them, then change the plot order with self.set_indexs_plot_lines</span>
<span class="sd">    kwargs_colorbar, optional</span>
<span class="sd">        Extra arguments for the colorbar (if z is not None)</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    kwargs, optional</span>
<span class="sd">        Additional argument to plot() function like linestyle, color....</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    Graphique.line : Build line(s) for the Graphique</span>
<span class="sd">    Graphique.loglog : Graphique.line in log coordinate for boths x and y axis</span>
<span class="sd">    Graphique.logy : Graphique.line in log coordinate for y axis and linear for x axis</span>
<span class="sd">    Graphique.point : To plot a single point</span>
<span class="sd">    Graphique.errorbar : To plot a line with errorbars</span>
<span class="sd">    Graphique.errorplot : To plot a line with errorbars represanted as filled area</span>
<span class="sd">    Graphique.polar : To plot a line in polar coordinates</span>
<span class="sd">    Graphique.symloglog : Similar to Graphique.loglog but boths negatives and positives values are represanted</span>
<span class="sd">    Graphique.symlogx : Similar to Graphique.logx but boths negatives and positives values are represanted</span>

<span class="sd">    Notes</span>
<span class="sd">    -------</span>
<span class="sd">    This function has a small improuvment compared with plt.plot :</span>

<span class="sd">    if y is in two dimensions, the second dimension is plotted :</span>
<span class="sd">        - ```symlogy(x,[y1,y2], *args)``` is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, *args)</span>
<span class="sd">            ax.plot(x, y2, *args)</span>
<span class="sd">            ax.set(yscale=&quot;symlog&quot;)```</span>
<span class="sd">        - if y1 and y2 have not the same size:</span>
<span class="sd">            ```symlogy([x1,x2],[y1, y2], *args)```</span>
<span class="sd">        - If others arguments are list of the same size of x and y, they are also split :</span>
<span class="sd">            ```symlogy((x1, x2], [y1, y2], marker=&quot;.&quot;, label=[&quot;Curve1&quot;, &quot;Curve2&quot;])```</span>
<span class="sd">            is equivalent to</span>
<span class="sd">            ```ax = plt.subplot()</span>
<span class="sd">            ax.plot(x, y1, marker=&quot;.&quot;, label=&quot;Curve1&quot;)</span>
<span class="sd">            ax.plot(x, y2, marker=&quot;.&quot;, label=&quot;Curve2&quot;)</span>
<span class="sd">            ax.set(yscale=&quot;symlog&quot;)```</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; x = np.linspace(0,np.pi,1000)</span>
<span class="sd">    &gt;&gt;&gt; gr = gr.symlogy(x, np.tan(x))</span>
<span class="sd">    &gt;&gt;&gt; gr.show()</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">symlogy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">share_colorbar</span><span class="o">=</span><span class="n">share_colorbar</span><span class="p">,</span>
                  <span class="n">scale_z</span><span class="o">=</span><span class="n">scale_z</span><span class="p">,</span> <span class="n">hide</span><span class="o">=</span><span class="n">hide</span><span class="p">,</span> <span class="n">kwargs_colorbar</span><span class="o">=</span><span class="n">kwargs_colorbar</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="histogram">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.histogram">[docs]</a>
<span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">weights</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
              <span class="n">normalization</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">statistic</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
              <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot the histogram of values</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : array_like</span>
<span class="sd">        The values to histogramed</span>
<span class="sd">    weights : array_like, optional</span>
<span class="sd">        The weights to be applied to values</span>
<span class="sd">    normalization : bool, optional, default=True</span>
<span class="sd">        If the histogram is normalized or not</span>
<span class="sd">    statistic : str, optional, default=&quot;sum&quot;</span>
<span class="sd">        The statistic to compute (default is &#39;sum&#39;).</span>
<span class="sd">        The following statistics are available:</span>

<span class="sd">            - &#39;mean&#39;: compute the mean of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">            - &#39;std&#39;: compute the standard deviation within each bin. This is implicitly calculated with ddof=0.</span>
<span class="sd">            - &#39;median&#39;: compute the median of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">            - &#39;count&#39;: compute the count of points within each bin. This is identical to an unweighted histogram. values array is not</span>
<span class="sd">                referenced.</span>
<span class="sd">            - &#39;sum&#39;: compute the sum of values for points within each bin. This is identical to a weighted histogram.</span>
<span class="sd">            - &#39;min&#39;: compute the minimum of values for points within each bin. Empty bins will be represented by NaN.</span>
<span class="sd">            - &#39;max&#39;: compute the maximum of values for point within each bin. Empty bins will be represented by NaN.</span>

<span class="sd">    bins : int, optional, default=10</span>
<span class="sd">        Number of bins in the histogram</span>
<span class="sd">    stat_args, dict, optional</span>
<span class="sd">        Additionals argument for `sp.binned_statistic`</span>
<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    kwargs</span>
<span class="sd">         Additionals argument for plt.bars</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    scipy.stats.binned_statistic</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">weights</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">poids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
        <span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="n">normalization</span><span class="p">,</span> <span class="n">statistic</span><span class="o">=</span><span class="n">statistic</span><span class="p">,</span>
        <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="image">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.image">[docs]</a>
<span class="k">def</span> <span class="nf">image</span><span class="p">(</span><span class="n">array_image</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
          <span class="n">x_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y_axe</span><span class="p">:</span> <span class="nb">list</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
          <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Plot the array image through plt.pcolor or plt.imshow for 3 color images</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    array_image : np.ndarray</span>
<span class="sd">        The matrix (2D, or 3D for colored images (the color is on the third axis)) to be plotted</span>
<span class="sd">    x_axe : list | np.ndarray, optional, default=np.linespace(0,array_image.shape[0])</span>
<span class="sd">        The x-axes coordinate (for the array), only for 2d array_image</span>
<span class="sd">    y_axe : list | np.ndarray, optional, default=np.linespace(0,array_image.shape[1])</span>
<span class="sd">        The y-axes coordinate (for the array), only for 2d array_image</span>
<span class="sd">    colorscale : str, optional, default=&quot;linear&quot;, {&quot;linear&quot;, &quot;log&quot;, &quot;symlog&quot;}</span>
<span class="sd">        The scale for the colorbar</span>
<span class="sd">    cmap : str, optional, default=&quot;default&quot;</span>
<span class="sd">        The colormap, default a linear color interpolation between two colors CX</span>
<span class="sd">    colorbar_ticks : list | array_like, optional</span>
<span class="sd">        The colorbar&#39;s ticks</span>
<span class="sd">    colorbar_label : str, optional, default=&quot;&quot;</span>
<span class="sd">        The colorbar&#39;s label</span>
<span class="sd">    kwargs_colorbar : dict, optional</span>
<span class="sd">        Additional arguments for the colorbar :</span>
<span class="sd">            - location: str, {&#39;right&#39;, &#39;top&#39;, &#39;bottom&#39;, &#39;left&#39;}</span>
<span class="sd">                Indicate where the colorbar should be plotted</span>
<span class="sd">            - scale: str, {&#39;linear&#39;, &#39;log&#39;, &#39;symlog&#39;}</span>
<span class="sd">                The scale of the colorbar</span>
<span class="sd">            - ticks: list | array_like</span>
<span class="sd">            - format: str</span>
<span class="sd">                ticks&#39; format</span>
<span class="sd">            - label: str</span>
<span class="sd">                The label to plot along the colorbar</span>
<span class="sd">            - size: float, default=0.01</span>
<span class="sd">                relative width of the colorbar</span>
<span class="sd">            - fraction: float, default=1</span>
<span class="sd">                relative hight of the colorbar</span>
<span class="sd">            - space_between: float, default=0.01</span>
<span class="sd">                relative space between colorsbars (and the plot)</span>

<span class="sd">    colorbar_index : int, optional</span>
<span class="sd">        The index of a previouly defined colorbar, to use insted of building a new one, all the others colorbar are</span>
<span class="sd">        ignored if provided</span>
<span class="sd">    vmin : np.float64, optional, default : the minimum of array_image</span>
<span class="sd">        The minimum value for the colorbar</span>
<span class="sd">    vmax : np.float64, optional, default : the maximum of array_image</span>
<span class="sd">        The maximum value for the colorbar</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>
<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique</span>
<span class="sd">    kwargs</span>
<span class="sd">        Additionals arguments for pcolor</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        None</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>

<span class="sd">    matplotlib.pyplot.pcolor</span>
<span class="sd">        Use to plot 2d array images</span>
<span class="sd">    matplotlib.pyplot.imshow</span>
<span class="sd">        Use to plot 3-colors images</span>
<span class="sd">    Graphique.contours</span>
<span class="sd">        To draw levels lines onto the image</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
    <span class="n">graph</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="n">array_image</span><span class="o">=</span><span class="n">array_image</span><span class="p">,</span> <span class="n">x_axe</span><span class="o">=</span><span class="n">x_axe</span><span class="p">,</span> <span class="n">y_axe</span><span class="o">=</span><span class="n">y_axe</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">graph</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">graph</span></div>



<div class="viewcode-block" id="level_surface">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.level_surface">[docs]</a>
<span class="k">def</span> <span class="nf">level_surface</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span>
                  <span class="n">vals</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="nb">list</span><span class="p">,</span> <span class="n">npix_x</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span> <span class="n">npix_y</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">400</span><span class="p">,</span>
                  <span class="n">logx</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">logy</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                  <span class="n">method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;cubic&#39;</span><span class="p">,</span> <span class="n">log_vals</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;bl&quot;</span><span class="p">,</span>
                  <span class="n">show</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graphique</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Returns an image representing the 2d contour line associated with the points</span>
<span class="sd">    points defined by x, y, vals</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : np.ndarray | list</span>
<span class="sd">        list of size n and dimension 1</span>
<span class="sd">        containing the abscissa of the points</span>
<span class="sd">    y : np.ndarray | list</span>
<span class="sd">        list of size n and dimension 1</span>
<span class="sd">        containing the odrides of the points</span>
<span class="sd">    vals : np.ndarray | list</span>
<span class="sd">        list of size n and dimension 1</span>
<span class="sd">        containing point values to be interpolated and displayed</span>
<span class="sd">    npix_x : int, optional, default = 400</span>
<span class="sd">        number of image pixels on x axis</span>
<span class="sd">    npix_y : int, optional, default = 400</span>
<span class="sd">        number of image pixels on y axis</span>
<span class="sd">    logx : bool, optional, default = False</span>
<span class="sd">        indicates whether the x axis is logarithmically subdivided or not</span>
<span class="sd">    logy : bool, optional, default = False</span>
<span class="sd">        indicates whether the y axis is logarithmically subdivided or not</span>
<span class="sd">    method : str, optional, default = &quot;cubic</span>
<span class="sd">        interplotation method: &#39;nearest&#39;, &#39;linear&#39; where by default</span>
<span class="sd">        &#39;cubic&#39;. See doc scipy.interpolate.griddata</span>
<span class="sd">    log_vals : bool, optional, default = False</span>
<span class="sd">        indicates whether values are displayed (and extrapolated) on a logarithmic scale or not.</span>
<span class="sd">        on a logarithmic scale</span>
<span class="sd">    axis_config : str, optional, {&quot;bl&quot;, &quot;tl&quot;, &quot;br&quot;, &quot;tr&quot;}, default=&quot;bl&quot;</span>
<span class="sd">        The positions of x-y axis :</span>

<span class="sd">            - &quot;bl&quot; is x-axis on the bottom, y-axis on the left (default).</span>
<span class="sd">            - &quot;tl&quot; is x-axis on the top, y-axis on the left.</span>
<span class="sd">            - &quot;br&quot; is x-axis on the bottom, y-axis on the right.</span>
<span class="sd">            - &quot;tr&quot; is x-axis on the top, y-axis on the right.</span>

<span class="sd">    show : bool, optional, default = True</span>
<span class="sd">        To show the Graphique (default=True)</span>
<span class="sd">    kwargs</span>
<span class="sd">        dictionaries of complementary arguments to images</span>
<span class="sd">        </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    Graphique</span>
<span class="sd">        The new Graphique</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">axis_config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;bl&quot;</span><span class="p">,</span> <span class="s2">&quot;tl&quot;</span><span class="p">,</span> <span class="s2">&quot;tr&quot;</span><span class="p">,</span> <span class="s2">&quot;br&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;The axis configuration can only be &quot;bl&quot;, &quot;tl&quot;; &quot;tr&quot; or &quot;br&quot;, not &quot;&quot;&quot;</span><span class="p">,</span> <span class="n">axis_config</span><span class="p">)</span>

    <span class="n">points</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">if</span> <span class="n">logx</span><span class="p">:</span>
        <span class="n">x_int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">npix_x</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">npix_x</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">logy</span><span class="p">:</span>
        <span class="n">y_int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">npix_y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">y_int</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="n">npix_y</span><span class="p">)</span>
    <span class="n">xi_x</span><span class="p">,</span> <span class="n">xi_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_int</span><span class="p">,</span> <span class="n">y_int</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">log_vals</span><span class="p">:</span>
        <span class="n">tab</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">vals</span><span class="p">),</span>
                                   <span class="n">xi</span><span class="o">=</span><span class="p">(</span><span class="n">xi_x</span><span class="p">,</span> <span class="n">xi_y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span> <span class="n">rescale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">tab</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="n">tab</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tab</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">tab</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">tab</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">griddata</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">xi</span><span class="o">=</span><span class="p">(</span><span class="n">xi_x</span><span class="p">,</span> <span class="n">xi_y</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>

    <span class="n">res</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="n">image</span><span class="p">(</span><span class="n">tab</span><span class="p">,</span> <span class="n">x_int</span><span class="p">,</span> <span class="n">y_int</span><span class="p">,</span> <span class="n">shading</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">axis_config</span><span class="o">=</span><span class="n">axis_config</span><span class="p">,</span>
                           <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">config_colorbar</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">res</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="Multigraph">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph">[docs]</a>
<span class="k">class</span> <span class="nc">Multigraph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    To plot multiples Graphiques in a single Figure</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To build a Multigraph</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nrows : int, optional, default=1</span>
<span class="sd">            Numbers of rows in the array containing the Graphiques</span>
<span class="sd">        ncols : int, optional, default=1</span>
<span class="sd">            Numbers of collumns in the array containing the Graphiques</span>
<span class="sd">        filename : str, optional, default=&quot;&quot;</span>
<span class="sd">            To load an existing Multigraph (if not &quot;&quot;)</span>
<span class="sd">        directory : str, optional, default=&quot;&quot;</span>
<span class="sd">            The directory of the loaded Multigraph, if filename != &quot;&quot;. If filename</span>
<span class="sd">            alreaday contain the total path, the directory is automaticaly deduced</span>

<span class="sd">        Notes</span>
<span class="sd">        ----------</span>
<span class="sd">        If a nrows is a string it will be interpredted as nrows=filename</span>
<span class="sd">        ```mg=Multigraph(&quot;filename&quot;)``` will try to load the Mutigraph filename</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nrow</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">nrows</span>
            <span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="s1">&#39;.npz&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;graph_without_name&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.png&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>  <span class="c1"># global style:</span>
        <span class="c1"># styles available: plt.style.available : &#39;default&#39; &#39;Solarize_Light2&#39;</span>
        <span class="c1"># &#39;_classic_test_patch&#39; &#39;_mpl-gallery&#39; &#39;_mpl-gallery-nogrid&#39;</span>
        <span class="c1"># &#39;bmh&#39; &#39;classic&#39; &#39;dark_background&#39; &#39;fast&#39; &#39;fivethirtyeight&#39; &#39;ggplot&#39;</span>
        <span class="c1"># &#39;grayscale&#39; &#39;seaborn&#39; &#39;seaborn-bright&#39; &#39;seaborn-colorblind&#39; &#39;seaborn-dark&#39; &#39;seaborn-dark-palette&#39;</span>
        <span class="c1"># &#39;seaborn-darkgrid&#39; &#39;seaborn-deep&#39; &#39;seaborn-muted&#39; &#39;seaborn-notebook&#39; &#39;seaborn-paper&#39; &#39;seaborn-pastel&#39;</span>
        <span class="c1"># &#39;seaborn-poster&#39; &#39;seaborn-talk&#39; &#39;seaborn-ticks&#39; &#39;seaborn-white&#39; &#39;seaborn-whitegrid&#39; &#39;tableau-colorblind10&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;font.size&quot;</span><span class="p">:</span> <span class="mi">13</span><span class="p">}</span>  <span class="c1"># Contains additional parameters for global font management</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Contains additional parameters for the Figure ex : facecolor=&quot;w&quot;...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_grid_spec</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Contains additional parameters for the grid : hspace, vspace...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">bbox_inches</span><span class="o">=</span><span class="s2">&quot;tight&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">nrows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Graphique</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_sharex_axis_coord</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_sharey_axis_coord</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_subplot</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List of coordinates of the occupy slots to test if a Graphique</span>
        <span class="c1"># could be added with a new set of coordinate</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
            <span class="k">if</span> <span class="n">directory</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
            <span class="k">elif</span> <span class="s2">&quot;/&quot;</span> <span class="ow">in</span> <span class="n">directory</span><span class="p">:</span>
                <span class="n">i</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="c1"># Cherche la dernière occurrence de &quot;/&quot;</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="n">i</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="s2">&quot;./&quot;</span>
            <span class="n">values_files</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">lib</span><span class="o">.</span><span class="n">npyio</span><span class="o">.</span><span class="n">NpzFile</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">directory</span> <span class="o">+</span> <span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">)</span>
            <span class="n">values_to_load</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">ndarray_dict_to_dict</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">values_files</span><span class="p">))</span>
            <span class="n">values_files</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_dict</span><span class="p">(</span><span class="n">values_to_load</span><span class="p">)</span>

<div class="viewcode-block" id="Multigraph.load_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.load_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">load_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values_to_load</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        load a Graphix contain in a dictionary</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values_to_load : dict</span>
<span class="sd">            Dictionary containing all the information needed to build a Multigraph.</span>
<span class="sd">            This dictionary is produced by Multigraph.to_dict()</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        Multigraph.to_dict</span>
<span class="sd">            Produce a dictionary that can be used to build a new Multigraph</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;ext&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;ext&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;style&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_font&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_font&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_fig&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_fig&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_enrg_fig&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_enrg_fig&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_grid_spec&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_grid_spec</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_grid_spec&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;nrows&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;nrows&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;ncols&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;ncols&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;list_Graphs&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;list_Graphs&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;list_coords&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;list_coords&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;list_sharex_axis_coord&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_sharex_axis_coord</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;list_sharex_axis_coord&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;list_sharey_axis_coord&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">list_sharey_axis_coord</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;list_sharey_axis_coord&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;occupy_coordinates&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;occupy_coordinates&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;param_subplot&quot;</span> <span class="ow">in</span> <span class="n">values_to_load</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">param_subplot</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">values_to_load</span><span class="p">[</span><span class="s2">&quot;param_subplot&quot;</span><span class="p">]</span></div>


<div class="viewcode-block" id="Multigraph.to_dict">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.to_dict">[docs]</a>
    <span class="k">def</span> <span class="nf">to_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Build a dictionary to be saved with np.saved_compressed</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dict</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        Multigraph.load_dict</span>
<span class="sd">            To load the produced dictionary in another Multigraph</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">enrg</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Dictionary containing all the necessary information :</span>
        <span class="c1"># Used like :  np.savez_compressed(name_fichier,**enrg)</span>

        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;ext&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;style&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_font&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_fig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_enrg_fig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_grid_spec&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_grid_spec</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;nrows&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;ncols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;list_Graphs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;list_coords&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;list_sharex_axis_coord&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_sharex_axis_coord</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;list_sharey_axis_coord&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_sharey_axis_coord</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;occupy_coordinates&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span>
        <span class="n">enrg</span><span class="p">[</span><span class="s2">&quot;param_subplot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_subplot</span>

        <span class="k">return</span> <span class="n">enrg</span></div>


<div class="viewcode-block" id="Multigraph.save">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.save">[docs]</a>
    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;mgraph_without_name&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Save the Multi.graph in self.directory (default the current working directory) in npz compressed</span>
<span class="sd">        format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str, optinal, default=&quot;mgraph_without_name&quot;</span>
<span class="sd">            The name of the .npz file (default: &quot;mgraph_without_name&quot;)</span>
<span class="sd">        directory: str, optional, default=&quot;./&quot;</span>
<span class="sd">            Graphique&#39;s directory (default self.directory (default : the curent working directory))</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="s2">&quot;mgraph_without_name&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;.npz&quot;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="p">[:</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="k">if</span> <span class="n">directory</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">=</span> <span class="n">directory</span>
        <span class="n">enrg</span> <span class="o">=</span> <span class="n">dict_to_ndarray_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(),</span> <span class="n">separator</span><span class="o">=</span><span class="s2">&quot;-.-&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;.npz&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;.npz&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">directory</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;/&quot;</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">np</span><span class="o">.</span><span class="n">savez_compressed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">enrg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.add_graphique">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.add_graphique">[docs]</a>
    <span class="k">def</span> <span class="nf">add_graphique</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coord</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">],</span> <span class="n">graph</span><span class="p">:</span> <span class="n">Graphique</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">sharex</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">sharey</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To add a new Graphique in the Multigraph at the coordinates defined by coord.</span>
<span class="sd">        This Graphique can cover several slots</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coord : int | list[int, tuple]</span>
<span class="sd">            the Graphique&#39;s coordinates : if self.nrows or nself.ncols =1 it can be an int, either a list</span>
<span class="sd">            of int :</span>
<span class="sd">            [index_rows, index_cols]. If this Graphique extend on severals slots, coord should be on this form :</span>
<span class="sd">            [(index_rows_min, index_rows_max), (index_cols_min, index_cols_min)]</span>
<span class="sd">        graph : Graphique, optional, default : an empty Graphique</span>
<span class="sd">            The Graphique to add, default a new empty Graphique is created</span>
<span class="sd">        sharex : int | list[int, tuple], optional</span>
<span class="sd">            Coordinates of the Graphique to wich the x axis is shared if needed. The corresponding Graphique</span>
<span class="sd">            should already be in the Multigraph. If the new Graphique is on multiples slots then the Graphique to which the</span>
<span class="sd">            coordinates are shared should occupy the same number of raw.</span>
<span class="sd">        sharey : int | list[int, tuple], optional</span>
<span class="sd">            Coordinates of the Graphique to wich the y axis is shared if needed. The corresponding Graphique</span>
<span class="sd">            should already be in the Multigraph. If the new Graphique is on multiples slots then the Graphique to which the</span>
<span class="sd">            coordinates are shared should occupy the same number of cols</span>
<span class="sd">        kwargs</span>
<span class="sd">            Extra-parameters for plt.subplot</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">Graphique</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">Graphique</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : graph should be a Graphique not a &quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">graph</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The Multigraph isn&#39;t linear nrow=&quot;</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="s2">&quot;ncols=&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span>
                              <span class="s2">&quot;The coordinate of the added Graphique should be a list, not an int&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coord</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The coordinate of the added Graphique &quot;</span><span class="p">,</span>
                              <span class="n">coord</span><span class="p">,</span> <span class="s2">&quot;is higher than the maximum :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The first coordinate of the added Graphique &quot;</span><span class="p">,</span>
                              <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;is higher than the maximum :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The second coordinate of the added Graphique &quot;</span><span class="p">,</span>
                              <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;is higher than the maximum :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The first maximum coordinate of the added Graphique &quot;</span><span class="p">,</span>
                              <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;is higher than the maximum :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_Graphique : The second maximum coordinate of the added Graphique &quot;</span><span class="p">,</span>
                              <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;is higher han the maximum :&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">occupy_coordinates</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coord</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">+</span> <span class="n">coord</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span>
                <span class="k">if</span> <span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : &quot;</span>
                                      <span class="s2">&quot;The coordinate &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">coord</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">coord</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">coord</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">+</span> <span class="n">coord</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span>
                <span class="k">if</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">coord</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">coord</span><span class="p">]</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : The coordinate &quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">coord</span><span class="p">],</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">coord</span><span class="p">])</span>
                <span class="n">coord</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">coord</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : The coordinate &quot;</span><span class="p">,</span> <span class="n">coord</span><span class="p">,</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : The coordinate &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">],</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">i</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">if</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : The coordinate &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="k">if</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span> <span class="ow">or</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">occupy_coordinates</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : The coordinate &quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="s2">&quot;is already occupy&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sharex</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : there is no Graphique at the coordinates indicates&quot;</span>
                              <span class="s2">&quot; for the sharex parameter&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sharex</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                    <span class="s2">&quot;Multigraph.add_graphique : the second coordinates of the sharex Graphique doesn&#39;t match &quot;</span>
                    <span class="s2">&quot;with the new coordinates&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sharex</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii_max</span><span class="p">,</span> <span class="n">ii_max</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">sharey</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span><span class="s2">&quot;Multigraph.add_graphique : there is no Graphique at the coordinates indicates&quot;</span>
                              <span class="s2">&quot; for the sharey parameter&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">sharey</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">UserWarning</span><span class="p">(</span>
                    <span class="s2">&quot;Multigraph.add_graphique : the first coordinates of the sharey Graphique doesn&#39;t match &quot;</span>
                    <span class="s2">&quot;with the new coordinates&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sharey</span> <span class="o">=</span> <span class="p">[</span><span class="n">ii_max</span><span class="p">,</span> <span class="n">ii_max</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">occupy_coordinates</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">occupy_coordinates</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">graph</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_sharex_axis_coord</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sharex</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">list_sharey_axis_coord</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sharey</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_subplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.config_fig">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.config_fig">[docs]</a>
    <span class="k">def</span> <span class="nf">config_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Additionals parameters for the Figure saving</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>

<span class="sd">            - igsize 2-tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>

<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>

<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>

<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>

<span class="sd">            - linewidth float</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameon bool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;onstrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes</span>
<span class="sd">                     decorations. Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                    fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the</span>
<span class="sd">                     subplot parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                     more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                      provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their</span>
<span class="sd">                 config defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and</span>
<span class="sd">                 rcParams[&quot;figure.constrained_layout.use&quot;] (default: False).</span>

<span class="sd">            - alpha  scalar or None</span>

<span class="sd">            - animated  bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout  unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor  color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - label object</span>

<span class="sd">            - layout_engine {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout unknown</span>

<span class="sd">            - transform  Transform</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>

<span class="sd">        matplotlib.figure.Figure.savefig</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.config_enrg_fig">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.config_enrg_fig">[docs]</a>
    <span class="k">def</span> <span class="nf">config_enrg_fig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Additionals parameters for the Figure saving</span>
<span class="sd">        see https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.savefig.html#matplotlib.figure.Figure.savefig</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">            - figsize 2-tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>

<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>

<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>

<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>

<span class="sd">            - linewidth float</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameon bool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;onstrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    -- &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes</span>
<span class="sd">                     decorations. Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    -- &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                    fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    -- &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the</span>
<span class="sd">                     subplot parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                     more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                      provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their</span>
<span class="sd">                 config defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and</span>
<span class="sd">                 rcParams[&quot;figure.constrained_layout.use&quot;] (default: False).</span>

<span class="sd">            - alpha  scalar or None</span>

<span class="sd">            - animated  bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout  unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor  color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - label object</span>

<span class="sd">            - layout_engine {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout unknown</span>

<span class="sd">            - transform  Transform</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.config_grid_spec">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.config_grid_spec">[docs]</a>
    <span class="k">def</span> <span class="nf">config_grid_spec</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dico</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Additionals parameters for the grid_spec</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dico</span>

<span class="sd">            - left, right, top, bottomfloat, optional : Extent of the subplots as a fraction of figure width or height.</span>
<span class="sd">                Left cannot be larger than right, and bottom cannot be larger than top.</span>
<span class="sd">                If not given, the values will be inferred from a figure or rcParams at draw time.</span>
<span class="sd">                See also GridSpec.get_subplot_params.</span>

<span class="sd">            - wspace float, optional :</span>
<span class="sd">                The amount of width reserved for space between subplots, expressed as a fraction</span>
<span class="sd">                of the average axis width. If not given, the values will be inferred from a figure or rcParams</span>
<span class="sd">                when necessary. See also GridSpec.get_subplot_params.</span>

<span class="sd">            - hspace float, optional :</span>
<span class="sd">                The amount of height reserved for space between subplots, expressed as a</span>
<span class="sd">                fraction of the average axis height. If not given, the values will be inferred from a figure or rcParams</span>
<span class="sd">                when necessary. See also GridSpec.get_subplot_params.</span>

<span class="sd">            - width_ratios array-like of length ncols, optional :</span>
<span class="sd">                Defines the relative widths of the columns.</span>
<span class="sd">                Each column gets a relative width of width_ratios[i] / sum(width_ratios).</span>
<span class="sd">                If not given, all columns will have the same width.</span>

<span class="sd">            - height_ratios array-like of length nrows, optional</span>
<span class="sd">                Defines the relative heights of the rows.</span>
<span class="sd">                Each row gets a relative height of height_ratios[i] / sum(height_ratios).</span>
<span class="sd">                If not given, all rows will have the same height.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        matplotlib.gridspec.GridSpec</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_grid_spec</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dico</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.config_font">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.config_font">[docs]</a>
    <span class="k">def</span> <span class="nf">config_font</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dico</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Global font parameter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        kwargs</span>
<span class="sd">           &#39;family&#39; : &#39;fantasy&#39;,&#39;monospace&#39;,&#39;sans-serif&#39;,&#39;serif&#39;,&#39;cursive&#39;</span>
<span class="sd">           &#39;styles&#39; : &#39;normal&#39;, &#39;italic&#39;, &#39;oblique&#39;</span>
<span class="sd">           &#39;size&#39; : valeur numérique</span>
<span class="sd">           &#39;variants&#39; : &#39;normal&#39;, &#39;small-caps&#39;</span>
<span class="sd">           &#39;weight&#39; : &#39;light&#39;, &#39;normal&#39;, &#39;medium&#39;, &#39;semibold&#39;, &#39;bold&#39;, &#39;heavy&#39;, &#39;black&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">k</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">dico</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">vals</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">dico</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">dico</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">K</span><span class="p">,</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">vals</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;font.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">K</span><span class="p">:</span>
                <span class="n">dico</span><span class="p">[</span><span class="s1">&#39;font.&#39;</span> <span class="o">+</span> <span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dico</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="o">=</span> <span class="n">L</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dico</span><span class="p">)</span></div>


<div class="viewcode-block" id="Multigraph.plot">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.plot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot all the Multigraph&#39;s elements</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        in_Multigraph: bool, optional, default=False</span>
<span class="sd">            If the Graphique is plotted in a Multigraph, it deactivate globals parameters such as</span>
<span class="sd">            the police or the style.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The style &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">style</span><span class="p">,</span> <span class="s2">&quot; is not awalible. </span><span class="se">\n</span><span class="s2"> Please use :</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">available</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">mpl</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_font</span><span class="p">):</span>
            <span class="n">param_fig</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;figsize&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">6.4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="mf">4.8</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">]}</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">param_fig</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">param_fig</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="o">**</span><span class="n">param_fig</span><span class="p">)</span>

            <span class="n">spec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">param_grid_spec</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">coords</span><span class="p">,</span> <span class="n">sharex</span><span class="p">,</span> <span class="n">sharey</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="p">,</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">list_sharex_axis_coord</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_sharey_axis_coord</span><span class="p">,</span>
                                                             <span class="bp">self</span><span class="o">.</span><span class="n">param_subplot</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharex</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">ii_max</span><span class="p">:</span>
                    <span class="n">sharex</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharex</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">sharex</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sharex</span><span class="p">)]</span><span class="o">.</span><span class="n">ax</span>
                <span class="c1"># else: sharex is bool</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharey</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sharey</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">ii_max</span><span class="p">:</span>
                    <span class="n">sharey</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">sharey</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">sharey</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">list_coords</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">sharey</span><span class="p">)]</span><span class="o">.</span><span class="n">ax</span>

                <span class="n">projection</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>
                <span class="k">if</span> <span class="s2">&quot;projection&quot;</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">param_ax</span><span class="p">:</span>
                    <span class="n">projection</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">param_ax</span><span class="p">[</span><span class="s2">&quot;projection&quot;</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="c1"># graph.ax = self.fig.add_subplot(spec[coords[0], coords[1]], projection=projection, sharex=sharex,</span>
                    <span class="c1">#                            sharey=sharey, **args)</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">sharex</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">sharey</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="c1"># graph.ax = self.fig.add_subplot(spec[coords[0], coords[1][0]:coords[1][1] + 1], projection=projection,</span>
                    <span class="c1">#                            sharex=sharex, sharey=sharey, **args)</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                                                    <span class="o">**</span><span class="n">args</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">sharex</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">sharey</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">int</span><span class="p">):</span>
                    <span class="c1"># graph.ax = self.fig.add_subplot(spec[coords[0][0]:coords[0][1] + 1, coords[1]], projection=projection,</span>
                    <span class="c1">#                            sharex=sharex, sharey=sharey, **args)</span>
                    <span class="c1">#</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span>
                                                    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span>
                                                    <span class="o">**</span><span class="n">args</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">sharex</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">sharey</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># graph.ax = self.fig.add_subplot(spec[coords[0][0]:coords[0][1] + 1, coords[1][0]:coords[1][1] + 1],</span>
                    <span class="c1">#                            projection=projection, sharex=sharex, sharey=sharey, **args)</span>
                    <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span><span class="n">coords</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                                                    <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharex</span><span class="p">(</span><span class="n">sharex</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">sharey</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">graph</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">sharey</span><span class="p">(</span><span class="n">sharey</span><span class="p">)</span>
                <span class="n">graph</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">in_Multigraph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span></div>


<div class="viewcode-block" id="Multigraph.save_figure">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.save_figure">[docs]</a>
    <span class="k">def</span> <span class="nf">save_figure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Save the image product by the Multigraph&#39;s plotting, not the Multigraph itself.</span>
<span class="sd">        The image is saved on the Multigraph&#39;s format (default .png)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args</span>
<span class="sd">            Additionals parameters for the Figure saving</span>
<span class="sd">            see https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.savefig.html#matplotlib.figure.Figure.savefig</span>

<span class="sd">            - igsize 2-tuple of floats, default: rcParams[&quot;figure.figsize&quot;] (default: [6.4, 4.8])</span>
<span class="sd">                Figure dimension (width, height) in inches.</span>

<span class="sd">            - dpi float, default: rcParams[&quot;figure.dpi&quot;] (default: 100.0)</span>
<span class="sd">                Dots per inch.</span>

<span class="sd">            - facecolor default: rcParams[&quot;figure.facecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch facecolor.</span>

<span class="sd">            - edgecolor default: rcParams[&quot;figure.edgecolor&quot;] (default: &#39;white&#39;)</span>
<span class="sd">                The figure patch edge color.</span>

<span class="sd">            - linewidth float</span>
<span class="sd">                The linewidth of the frame (i.e. the edge linewidth of the figure patch).</span>

<span class="sd">            - frameon bool, default: rcParams[&quot;figure.frameon&quot;] (default: True)</span>
<span class="sd">                If False, suppress drawing the figure background patch.</span>

<span class="sd">            - layout {&#39;onstrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}, default: None</span>

<span class="sd">                The layout mechanism for positioning of plot elements to avoid overlapping Axes decorations</span>
<span class="sd">                 (labels, ticks, etc). Note that layout managers can have significant performance penalties.</span>

<span class="sd">                    &#39;constrained&#39;: The constrained layout solver adjusts Axes sizes to avoid overlapping Axes</span>
<span class="sd">                     decorations. Can handle complex plot layouts and colorbars, and is thus recommended.</span>

<span class="sd">                    See Constrained layout guide for examples.</span>

<span class="sd">                    &#39;compressed&#39;: uses the same algorithm as &#39;constrained&#39;, but removes extra space between</span>
<span class="sd">                    fixed-aspect-ratio Axes. Best for simple grids of Axes.</span>

<span class="sd">                    &#39;tight&#39;: Use the tight layout mechanism. This is a relatively simple algorithm that adjusts the</span>
<span class="sd">                     subplot parameters so that decorations do not overlap.</span>

<span class="sd">                    See Tight layout guide for examples.</span>

<span class="sd">                    &#39;none&#39;: Do not use a layout engine.</span>

<span class="sd">                    A LayoutEngine instance. Builtin layout classes are ConstrainedLayoutEngine and TightLayoutEngine,</span>
<span class="sd">                     more easily accessible by &#39;constrained&#39; and &#39;tight&#39;. Passing an instance allows third parties to</span>
<span class="sd">                      provide their own layout engine.</span>

<span class="sd">                If not given, fall back to using the parameters tight_layout and constrained_layout, including their</span>
<span class="sd">                 config defaults rcParams[&quot;figure.autolayout&quot;] (default: False) and</span>
<span class="sd">                 rcParams[&quot;figure.constrained_layout.use&quot;] (default: False).</span>

<span class="sd">            - alpha  scalar or None</span>

<span class="sd">            - animated  bool</span>

<span class="sd">            - clip_on bool</span>

<span class="sd">            - constrained_layout  unknown</span>

<span class="sd">            - constrained_layout_pads unknown</span>

<span class="sd">            - dpi float</span>

<span class="sd">            - edgecolor color</span>

<span class="sd">            - facecolor  color</span>

<span class="sd">            - figheight float</span>

<span class="sd">            - figwidth float</span>

<span class="sd">            - frameon bool</span>

<span class="sd">            - gid str</span>

<span class="sd">            - in_layout bool</span>

<span class="sd">            - label object</span>

<span class="sd">            - layout_engine {&#39;constrained&#39;, &#39;compressed&#39;, &#39;tight&#39;, &#39;none&#39;, LayoutEngine, None}</span>

<span class="sd">            - linewidth number</span>

<span class="sd">            - mouseover bool</span>

<span class="sd">            - picker None or bool or float</span>

<span class="sd">            - rasterized bool</span>

<span class="sd">            - size_inches (float, float) or float</span>

<span class="sd">            - sketch_params (scale: float, length: float, randomness: float)</span>

<span class="sd">            - snap bool or None</span>

<span class="sd">            - tight_layout unknown</span>

<span class="sd">            - transform  Transform</span>

<span class="sd">            - url str</span>

<span class="sd">            - visible bool</span>

<span class="sd">            - zorder float</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">args_enrg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_enrg_fig</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">args_enrg</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="k">if</span> <span class="s2">&quot;.&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ext</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directory</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ext</span><span class="p">,</span> <span class="o">**</span><span class="n">args_enrg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">:</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Multigraph.show">
<a class="viewcode-back" href="../../phenigraph.html#phenigraph.objet.Multigraph.show">[docs]</a>
    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the Graphique</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            None</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">graph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_Graphs</span><span class="p">:</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">fig</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">graph</span><span class="o">.</span><span class="n">ax</span> <span class="o">=</span> <span class="kc">None</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Paul Huet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>